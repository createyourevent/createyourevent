{"ast":null,"code":"import { UserPointAssociation } from \"app/entities/user-point-association/user-point-association.model\";\nimport * as dayjs from \"dayjs\";\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"app/entities/image/service/image.service\";\nimport * as i2 from \"app/general.service\";\nimport * as i3 from \"app/points/points-display/points-display.service\";\nimport * as i4 from \"app/entities/user-point-association/service/user-point-association.service\";\nimport * as i5 from \"@angular/common\";\nimport * as i6 from \"@fortawesome/angular-fontawesome\";\nimport * as i7 from \"../../../shared/language/translate.directive\";\nimport * as i8 from \"primeng/fileupload\";\nimport * as i9 from \"primeng/api\";\nimport * as i10 from \"../gallery-service/gallery-service.component\";\nfunction AdminGalleryServiceComponent_ng_container_0_ng_template_4_ul_1_li_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"li\");\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const file_r5 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate2(\"\", file_r5.name, \" - \", file_r5.size, \" bytes\");\n  }\n}\nfunction AdminGalleryServiceComponent_ng_container_0_ng_template_4_ul_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ul\");\n    i0.ɵɵtext(1, \"\\n                \");\n    i0.ɵɵtemplate(2, AdminGalleryServiceComponent_ng_container_0_ng_template_4_ul_1_li_2_Template, 2, 2, \"li\", 1);\n    i0.ɵɵtext(3, \"\\n            \");\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r3 = i0.ɵɵnextContext(3);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r3.uploadedFiles);\n  }\n}\nfunction AdminGalleryServiceComponent_ng_container_0_ng_template_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵtext(0, \"\\n            \");\n    i0.ɵɵtemplate(1, AdminGalleryServiceComponent_ng_container_0_ng_template_4_ul_1_Template, 4, 1, \"ul\", 0);\n    i0.ɵɵtext(2, \"\\n        \");\n  }\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r2.uploadedFiles.length);\n  }\n}\nfunction AdminGalleryServiceComponent_ng_container_0_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r7 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵtext(1, \"\\n    \");\n    i0.ɵɵelementStart(2, \"p-fileUpload\", 3);\n    i0.ɵɵlistener(\"onUpload\", function AdminGalleryServiceComponent_ng_container_0_Template_p_fileUpload_onUpload_2_listener($event) {\n      i0.ɵɵrestoreView(_r7);\n      const ctx_r6 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r6.onUpload($event));\n    });\n    i0.ɵɵtext(3, \"\\n        \");\n    i0.ɵɵtemplate(4, AdminGalleryServiceComponent_ng_container_0_ng_template_4_Template, 3, 1, \"ng-template\", 4);\n    i0.ɵɵtext(5, \"\\n    \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(6, \"\\n\");\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"url\", ctx_r0.url)(\"fileLimit\", ctx_r0.fileLimit);\n  }\n}\nfunction AdminGalleryServiceComponent_ng_container_4_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r10 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵtext(1, \"\\n        \");\n    i0.ɵɵelementStart(2, \"div\", 5);\n    i0.ɵɵtext(3, \"\\n            \");\n    i0.ɵɵelement(4, \"img\", 6);\n    i0.ɵɵtext(5, \"\\n\\n            \");\n    i0.ɵɵelementStart(6, \"button\", 7);\n    i0.ɵɵlistener(\"click\", function AdminGalleryServiceComponent_ng_container_4_Template_button_click_6_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r10);\n      const image_r8 = restoredCtx.$implicit;\n      const ctx_r9 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r9.deleteImage(image_r8.id));\n    });\n    i0.ɵɵtext(7, \"\\n                \");\n    i0.ɵɵelement(8, \"fa-icon\", 8);\n    i0.ɵɵtext(9, \"\\n                \");\n    i0.ɵɵelementStart(10, \"span\", 9);\n    i0.ɵɵtext(11, \"Delete\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(12, \"\\n            \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(13, \"\\n        \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(14, \"\\n    \");\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    const image_r8 = ctx.$implicit;\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"src\", \"data:\" + image_r8.imageContentType + \";base64,\" + image_r8.image, i0.ɵɵsanitizeUrl);\n  }\n}\nexport class AdminGalleryServiceComponent {\n  constructor(imageService, generalService, pointsDataService, userPointAssociationService) {\n    this.imageService = imageService;\n    this.generalService = generalService;\n    this.pointsDataService = pointsDataService;\n    this.userPointAssociationService = userPointAssociationService;\n    this.uploadedFiles = [];\n    this.fileLimit = 10;\n  }\n  ngOnInit() {\n    this.url = '/api/upload/' + this.service.id + '/' + this.user.id + '/service';\n    this.generalService.findImagesByShopId(this.service.id).subscribe(res => {\n      this.images = res.body;\n      this.fileLimit = 10 - this.images.length;\n    });\n  }\n  ngOnChanges(changes) {\n    if (changes['service'] !== undefined) {\n      this.service = changes['service'].currentValue;\n      this.ngOnInit();\n    }\n    if (changes['user'] !== undefined) {\n      this.user = changes['user'].currentValue;\n      this.ngOnInit();\n    }\n  }\n  onUpload(event) {\n    for (const file of event.files) {\n      this.uploadedFiles.push(file);\n    }\n    this.generalService.findPointsByKey('upload_image_service').subscribe(p => {\n      const points = p.body;\n      this.generalService.findUserPointAssociationByUsersIdAndPointkey(this.user.id, points.key).subscribe(s => {\n        const upa = s.body;\n        const day = dayjs().date();\n        let i = 0;\n        upa.forEach(element => {\n          if (element.date.date() === day) {\n            i++;\n          }\n        });\n        if (i < points.countPerDay) {\n          const iupa = new UserPointAssociation();\n          iupa.users = this.user;\n          iupa.points = points;\n          iupa.date = dayjs();\n          this.userPointAssociationService.create(iupa).subscribe();\n          const img_points = points.points * this.uploadedFiles.length;\n          this.user.points += img_points;\n          this.user.loggedIn = true;\n          this.generalService.updateUserLoggedInAndPoints(this.user.id, this.user.loggedIn, this.user.points).subscribe(t => {\n            this.generalService.findWidthAuthorities().subscribe(k => {\n              this.pointsDataService.changePoint(k.body.points);\n            });\n          });\n        }\n      });\n    });\n    this.generalService.findImagesByServiceId(this.service.id).subscribe(res => {\n      this.images = res.body;\n      this.fileLimit = 10 - this.images.length;\n    });\n  }\n  deleteImage(imageId) {\n    this.imageService.delete(imageId).subscribe(() => {\n      this.generalService.findImagesByServiceId(this.service.id).subscribe(res => {\n        this.images = res.body;\n        this.fileLimit = 10 - this.images.length;\n      });\n    });\n  }\n}\nAdminGalleryServiceComponent.ɵfac = function AdminGalleryServiceComponent_Factory(t) {\n  return new (t || AdminGalleryServiceComponent)(i0.ɵɵdirectiveInject(i1.ImageService), i0.ɵɵdirectiveInject(i2.GeneralService), i0.ɵɵdirectiveInject(i3.PointsDataService), i0.ɵɵdirectiveInject(i4.UserPointAssociationService));\n};\nAdminGalleryServiceComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: AdminGalleryServiceComponent,\n  selectors: [[\"jhi-admin-gallery-service\"]],\n  inputs: {\n    service: \"service\",\n    user: \"user\"\n  },\n  features: [i0.ɵɵNgOnChangesFeature],\n  decls: 14,\n  vars: 3,\n  consts: [[4, \"ngIf\"], [4, \"ngFor\", \"ngForOf\"], [3, \"images\"], [\"name\", \"files\", \"multiple\", \"multiple\", \"accept\", \"image/*\", \"maxFileSize\", \"1000000\", 3, \"url\", \"fileLimit\", \"onUpload\"], [\"pTemplate\", \"content\"], [1, \"image\"], [\"alt\", \"image.name\", 2, \"max-height\", \"150px\", 3, \"src\"], [1, \"btn\", \"btn-danger\", \"btn-sm\", 3, \"click\"], [\"icon\", \"times\"], [\"jhiTranslate\", \"entity.action.delete\", 1, \"d-none\", \"d-md-inline\"]],\n  template: function AdminGalleryServiceComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵtemplate(0, AdminGalleryServiceComponent_ng_container_0_Template, 7, 2, \"ng-container\", 0);\n      i0.ɵɵtext(1, \"\\n\");\n      i0.ɵɵelementStart(2, \"p\");\n      i0.ɵɵtext(3, \"\\n    \");\n      i0.ɵɵtemplate(4, AdminGalleryServiceComponent_ng_container_4_Template, 15, 1, \"ng-container\", 1);\n      i0.ɵɵtext(5, \"\\n\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(6, \"\\n\");\n      i0.ɵɵelement(7, \"hr\");\n      i0.ɵɵtext(8, \"\\n\");\n      i0.ɵɵelementStart(9, \"p\");\n      i0.ɵɵtext(10, \"\\n    \");\n      i0.ɵɵelement(11, \"jhi-gallery-service\", 2);\n      i0.ɵɵtext(12, \"\\n\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(13, \"\\n\");\n    }\n    if (rf & 2) {\n      i0.ɵɵproperty(\"ngIf\", ctx.service && ctx.user && !((ctx.images == null ? null : ctx.images.length) >= 10));\n      i0.ɵɵadvance(4);\n      i0.ɵɵproperty(\"ngForOf\", ctx.images);\n      i0.ɵɵadvance(7);\n      i0.ɵɵproperty(\"images\", ctx.images);\n    }\n  },\n  dependencies: [i5.NgForOf, i5.NgIf, i6.FaIconComponent, i7.TranslateDirective, i8.FileUpload, i9.PrimeTemplate, i10.GalleryServiceComponent],\n  styles: [\".image[_ngcontent-%COMP%] {\\n  margin: 15px;\\n}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9tYWluL3dlYmFwcC9hcHAvdmlld3Mvc2VydmljZS9hZG1pbi1nYWxsZXJ5LXNlcnZpY2UvYWRtaW4tZ2FsbGVyeS1zZXJ2aWNlLmNvbXBvbmVudC5zY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0VBQ0UsWUFBQTtBQUNGIiwic291cmNlc0NvbnRlbnQiOlsiLmltYWdlIHtcbiAgbWFyZ2luOiAxNXB4O1xufVxuIl0sInNvdXJjZVJvb3QiOiIifQ== */\"]\n});","map":{"version":3,"mappings":"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","names":["UserPointAssociation","dayjs","i0","AdminGalleryServiceComponent","constructor","imageService","generalService","pointsDataService","userPointAssociationService","ngOnInit","url","service","id","user","findImagesByShopId","subscribe","res","images","body","fileLimit","length","ngOnChanges","changes","undefined","currentValue","onUpload","event","file","files","uploadedFiles","push","findPointsByKey","p","points","findUserPointAssociationByUsersIdAndPointkey","key","s","upa","day","date","i","forEach","element","countPerDay","iupa","users","create","img_points","loggedIn","updateUserLoggedInAndPoints","t","findWidthAuthorities","k","changePoint","findImagesByServiceId","deleteImage","imageId","delete","selectors","inputs","features","decls","vars","consts","template"],"sourceRoot":"","sources":["/home/ceo/mmmm/createyourevent/src/main/webapp/app/views/service/admin-gallery-service/admin-gallery-service.component.ts","/home/ceo/mmmm/createyourevent/src/main/webapp/app/views/service/admin-gallery-service/admin-gallery-service.component.html"],"sourcesContent":["import { Component, OnInit, OnChanges, Input, SimpleChanges } from \"@angular/core\";\nimport { IImage } from \"app/entities/image/image.model\";\nimport { ImageService } from \"app/entities/image/service/image.service\";\nimport { IShop } from \"app/entities/shop/shop.model\";\nimport { UserPointAssociationService } from \"app/entities/user-point-association/service/user-point-association.service\";\nimport { UserPointAssociation } from \"app/entities/user-point-association/user-point-association.model\";\nimport { IUser } from \"app/entities/user/user.model\";\nimport { GeneralService } from \"app/general.service\";\nimport { PointsDataService } from \"app/points/points-display/points-display.service\";\nimport * as dayjs from \"dayjs\";\n\n@Component({\n  selector: 'jhi-admin-gallery-service',\n  templateUrl: './admin-gallery-service.component.html',\n  styleUrls: ['admin-gallery-service.component.scss']\n})\nexport class AdminGalleryServiceComponent implements OnInit, OnChanges {\n  @Input() service!: IShop;\n  @Input() user!: IUser;\n  uploadedFiles: any[] = [];\n  images!: IImage[];\n  url!: string;\n  fileLimit = 10;\n\n  constructor(\n    private imageService: ImageService,\n    private generalService: GeneralService,\n    private pointsDataService: PointsDataService,\n    private userPointAssociationService: UserPointAssociationService\n  ) {}\n  ngOnInit(): void {\n    this.url = '/api/upload/' + this.service.id + '/' + this.user.id + '/service';\n    this.generalService.findImagesByShopId(this.service.id!).subscribe(res => {\n      this.images = res.body!;\n      this.fileLimit = 10 - this.images.length;\n    });\n  }\n\n  ngOnChanges(changes: SimpleChanges): void {\n    if (changes['service'] !== undefined) {\n      this.service = changes['service'].currentValue;\n      this.ngOnInit();\n    }\n    if (changes['user'] !== undefined) {\n      this.user = changes['user'].currentValue;\n      this.ngOnInit();\n    }\n  }\n\n  onUpload(event: any): void {\n    for (const file of event.files) {\n      this.uploadedFiles.push(file);\n    }\n\n    this.generalService.findPointsByKey('upload_image_service').subscribe(p => {\n      const points = p.body!;\n      this.generalService.findUserPointAssociationByUsersIdAndPointkey(this.user.id!, points!.key!).subscribe(s => {\n        const upa = s.body!;\n        const day = dayjs().date();\n        let i = 0;\n        upa.forEach(element => {\n          if (element.date!.date() === day) {\n            i++;\n          }\n        });\n        if (i < points!.countPerDay!) {\n          const iupa = new UserPointAssociation();\n          iupa.users = this.user;\n          iupa.points = points;\n          iupa.date = dayjs();\n          this.userPointAssociationService.create(iupa).subscribe();\n          const img_points = points!.points! * this.uploadedFiles.length;\n          this.user.points! += img_points;\n          this.user.loggedIn = true;\n          this.generalService.updateUserLoggedInAndPoints(this.user.id!, this.user.loggedIn, this.user!.points!).subscribe(t => {\n            this.generalService.findWidthAuthorities().subscribe(k => {\n              this.pointsDataService.changePoint(k.body!.points!);\n            });\n          });\n        }\n      });\n    });\n\n    this.generalService.findImagesByServiceId(this.service.id!).subscribe(res => {\n      this.images = res.body!;\n      this.fileLimit = 10 - this.images.length;\n    });\n  }\n\n  deleteImage(imageId: number): void {\n    this.imageService.delete(imageId).subscribe(() => {\n      this.generalService.findImagesByServiceId(this.service.id!).subscribe(res => {\n        this.images = res.body!;\n        this.fileLimit = 10 - this.images.length;\n      });\n    });\n  }\n}\n","<ng-container *ngIf=\"service && user && !(images?.length >= 10)\">\n    <p-fileUpload name=\"files\" [url]=\"url\" (onUpload)=\"onUpload($event)\"\n            multiple=\"multiple\" accept=\"image/*\" maxFileSize=\"1000000\" [fileLimit]=\"fileLimit\">\n        <ng-template pTemplate=\"content\">\n            <ul *ngIf=\"uploadedFiles.length\">\n                <li *ngFor=\"let file of uploadedFiles\">{{file.name}} - {{file.size}} bytes</li>\n            </ul>\n        </ng-template>\n    </p-fileUpload>\n</ng-container>\n<p>\n    <ng-container *ngFor=\"let image of images\">\n        <div class=\"image\">\n            <img [src]=\"'data:' + image.imageContentType + ';base64,' + image.image\" style=\"max-height: 150px;\" alt=\"image.name\"/>\n\n            <button (click)=\"deleteImage(image.id)\" class=\"btn btn-danger btn-sm\">\n                <fa-icon icon=\"times\"></fa-icon>\n                <span class=\"d-none d-md-inline\" jhiTranslate=\"entity.action.delete\">Delete</span>\n            </button>\n        </div>\n    </ng-container>\n</p>\n<hr/>\n<p>\n    <jhi-gallery-service [images]=\"images\"></jhi-gallery-service>\n</p>\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}