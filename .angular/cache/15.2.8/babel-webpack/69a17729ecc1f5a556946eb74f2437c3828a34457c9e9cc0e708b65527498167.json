{"ast":null,"code":"import { GiftShoppingCart } from \"app/entities/gift-shopping-cart/gift-shopping-cart.model\";\nimport * as dayjs from \"dayjs\";\nimport { MessageService } from \"primeng/api\";\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"app/general.service\";\nimport * as i2 from \"app/entities/gift-shopping-cart/service/gift-shopping-cart.service\";\nimport * as i3 from \"primeng/api\";\nimport * as i4 from \"@ngx-translate/core\";\nimport * as i5 from \"app/entities/gift/service/gift.service\";\nimport * as i6 from \"../points-display/points-display.service\";\nimport * as i7 from \"@angular/router\";\nimport * as i8 from \"@angular/common\";\nimport * as i9 from \"../../shared/language/translate.directive\";\nimport * as i10 from \"../../shared/auth/has-any-authority.directive\";\nimport * as i11 from \"primeng/carousel\";\nimport * as i12 from \"primeng/card\";\nimport * as i13 from \"primeng/button\";\nimport * as i14 from \"primeng/toast\";\nfunction ExchangeComponent_ng_template_22_ng_template_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵtext(0, \"\\n                \");\n    i0.ɵɵelement(1, \"img\", 14);\n    i0.ɵɵtext(2, \"\\n            \");\n  }\n  if (rf & 2) {\n    const gift_r1 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"src\", \"data:\" + gift_r1.photoContentType + \";base64,\" + gift_r1.photo, i0.ɵɵsanitizeUrl);\n  }\n}\nfunction ExchangeComponent_ng_template_22_ng_template_40_ng_container_1_ng_container_2_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r9 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵtext(1, \"\\n                        \");\n    i0.ɵɵelementStart(2, \"button\", 17);\n    i0.ɵɵlistener(\"click\", function ExchangeComponent_ng_template_22_ng_template_40_ng_container_1_ng_container_2_Template_button_click_2_listener() {\n      i0.ɵɵrestoreView(_r9);\n      const gift_r1 = i0.ɵɵnextContext(3).$implicit;\n      const ctx_r7 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r7.exchange(gift_r1));\n    });\n    i0.ɵɵpipe(3, \"translate\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(4, \"\\n                    \");\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    i0.ɵɵadvance(2);\n    i0.ɵɵpropertyInterpolate(\"label\", i0.ɵɵpipeBind1(3, 1, \"exchange.exchange\"));\n  }\n}\nfunction ExchangeComponent_ng_template_22_ng_template_40_ng_container_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵtext(1, \"\\n                    \");\n    i0.ɵɵtemplate(2, ExchangeComponent_ng_template_22_ng_template_40_ng_container_1_ng_container_2_Template, 5, 3, \"ng-container\", 16);\n    i0.ɵɵtext(3, \"\\n                \");\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"jhiHasAnyAuthority\", \"ROLE_USER\");\n  }\n}\nfunction ExchangeComponent_ng_template_22_ng_template_40_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵtext(0, \"\\n                \");\n    i0.ɵɵtemplate(1, ExchangeComponent_ng_template_22_ng_template_40_ng_container_1_Template, 4, 1, \"ng-container\", 15);\n    i0.ɵɵtext(2, \"\\n            \");\n  }\n  if (rf & 2) {\n    const ctx_r3 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r3.user);\n  }\n}\nfunction ExchangeComponent_ng_template_22_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵtext(0, \"\\n        \");\n    i0.ɵɵelementStart(1, \"p-card\", 8);\n    i0.ɵɵtext(2, \"\\n            \");\n    i0.ɵɵtemplate(3, ExchangeComponent_ng_template_22_ng_template_3_Template, 3, 1, \"ng-template\", 9);\n    i0.ɵɵtext(4, \"\\n            \");\n    i0.ɵɵelementStart(5, \"dl\", 10);\n    i0.ɵɵtext(6, \"\\n                \");\n    i0.ɵɵelementStart(7, \"h3\")(8, \"span\");\n    i0.ɵɵtext(9);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵtext(10, \"\\n\\n                \");\n    i0.ɵɵelementStart(11, \"dd\");\n    i0.ɵɵtext(12, \"\\n                    \");\n    i0.ɵɵelementStart(13, \"span\");\n    i0.ɵɵtext(14);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(15, \"\\n                \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(16, \"\\n                \");\n    i0.ɵɵelement(17, \"hr\");\n    i0.ɵɵtext(18, \"\\n                \");\n    i0.ɵɵelementStart(19, \"dt\")(20, \"span\", 11);\n    i0.ɵɵtext(21, \"Points\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵtext(22, \"\\n                \");\n    i0.ɵɵelementStart(23, \"dd\");\n    i0.ɵɵtext(24, \"\\n                    \");\n    i0.ɵɵelementStart(25, \"span\");\n    i0.ɵɵtext(26);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(27, \"\\n                \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(28, \"\\n                \");\n    i0.ɵɵelementStart(29, \"dt\")(30, \"span\", 12);\n    i0.ɵɵtext(31, \"Stock\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵtext(32, \"\\n                \");\n    i0.ɵɵelementStart(33, \"dd\");\n    i0.ɵɵtext(34, \"\\n                    \");\n    i0.ɵɵelementStart(35, \"span\");\n    i0.ɵɵtext(36);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(37, \"\\n                \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(38, \"\\n            \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(39, \"\\n            \");\n    i0.ɵɵtemplate(40, ExchangeComponent_ng_template_22_ng_template_40_Template, 3, 1, \"ng-template\", 13);\n    i0.ɵɵtext(41, \"\\n        \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(42, \"\\n    \");\n  }\n  if (rf & 2) {\n    const gift_r1 = ctx.$implicit;\n    i0.ɵɵadvance(9);\n    i0.ɵɵtextInterpolate(gift_r1.title);\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate(gift_r1.description);\n    i0.ɵɵadvance(12);\n    i0.ɵɵtextInterpolate(gift_r1.points);\n    i0.ɵɵadvance(10);\n    i0.ɵɵtextInterpolate(gift_r1.stock);\n  }\n}\nexport let ExchangeComponent = /*#__PURE__*/(() => {\n  class ExchangeComponent {\n    constructor(generalService, giftShoppingCartService, messageService, translate, giftService, pointsData, router) {\n      this.generalService = generalService;\n      this.giftShoppingCartService = giftShoppingCartService;\n      this.messageService = messageService;\n      this.translate = translate;\n      this.giftService = giftService;\n      this.pointsData = pointsData;\n      this.router = router;\n    }\n    ngOnInit() {\n      this.generalService.findWidthAuthorities().subscribe(u => {\n        this.user = u.body;\n      });\n      this.generalService.findGiftsByActiveTrue().subscribe(res => {\n        if (!this.gifts) {\n          this.gifts = [];\n        }\n        res.body.forEach(element => {\n          if (element.stock > 0) {\n            this.gifts.push(element);\n          }\n        });\n      });\n    }\n    exchange(gift) {\n      if (gift.points > this.user.points) {\n        this.messageService.add({\n          key: 'myKey1',\n          severity: 'error',\n          summary: this.translate.instant('select-products.error'),\n          detail: this.translate.instant('exchange.too-few-points')\n        });\n        return;\n      }\n      const cart = new GiftShoppingCart();\n      cart.user = this.user;\n      cart.gift = gift;\n      cart.amount = 1;\n      cart.date = dayjs();\n      this.giftShoppingCartService.create(cart).subscribe(() => {\n        this.user.points -= gift.points;\n        this.pointsData.changePoint(this.user.points);\n        this.generalService.updateUserLoggedInAndPoints(this.user.id, this.user.loggedIn, this.user.points).subscribe();\n        gift.stock -= 1;\n        this.giftService.update(gift).subscribe();\n        this.router.navigate(['/my-gifts']);\n      });\n    }\n  }\n  ExchangeComponent.ɵfac = function ExchangeComponent_Factory(t) {\n    return new (t || ExchangeComponent)(i0.ɵɵdirectiveInject(i1.GeneralService), i0.ɵɵdirectiveInject(i2.GiftShoppingCartService), i0.ɵɵdirectiveInject(i3.MessageService), i0.ɵɵdirectiveInject(i4.TranslateService), i0.ɵɵdirectiveInject(i5.GiftService), i0.ɵɵdirectiveInject(i6.PointsDataService), i0.ɵɵdirectiveInject(i7.Router));\n  };\n  ExchangeComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: ExchangeComponent,\n    selectors: [[\"jhi-exchange\"]],\n    features: [i0.ɵɵProvidersFeature([MessageService])],\n    decls: 26,\n    vars: 3,\n    consts: [[\"key\", \"myKey1\"], [\"jhiTranslate\", \"exchange.title\", 1, \"monoton\"], [\"role\", \"alert\", 1, \"alert\", \"alert-primary\"], [\"jhiTranslate\", \"exchange.info\"], [1, \"box_yellow\"], [\"jhiTranslate\", \"exchange.all-gifts\", 1, \"monoton\"], [3, \"value\", \"numVisible\", \"numScroll\"], [\"pTemplate\", \"item\"], [1, \"card\"], [\"pTemplate\", \"header\"], [1, \"row-md\", \"jh-entity-details\"], [\"jhiTranslate\", \"exchange.points\"], [\"jhiTranslate\", \"exchange.stock\"], [\"pTemplate\", \"footer\"], [\"alt\", \"gift image\", 2, \"max-width\", \"250px\", 3, \"src\"], [4, \"ngIf\"], [4, \"jhiHasAnyAuthority\"], [\"pButton\", \"\", \"type\", \"button\", \"icon\", \"pi pi-heart\", \"iconPos\", \"left\", 3, \"label\", \"click\"]],\n    template: function ExchangeComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelement(0, \"p-toast\", 0);\n        i0.ɵɵtext(1, \"\\n\\n\");\n        i0.ɵɵelementStart(2, \"h1\", 1);\n        i0.ɵɵtext(3, \"Temple of gifts\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtext(4, \"\\n\\n\");\n        i0.ɵɵelementStart(5, \"div\", 2);\n        i0.ɵɵtext(6, \"\\n    \");\n        i0.ɵɵelementStart(7, \"span\", 3);\n        i0.ɵɵtext(8, \"\\n        On this page you can see all the gifts that you can exchange for your points. Most of the gifts are donations and we would like to thank all donors once again.\\n    \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtext(9, \"\\n\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtext(10, \"\\n\\n\");\n        i0.ɵɵelement(11, \"hr\");\n        i0.ɵɵtext(12, \"\\n\");\n        i0.ɵɵelementStart(13, \"div\", 4);\n        i0.ɵɵtext(14, \"\\n\");\n        i0.ɵɵelementStart(15, \"h2\", 5);\n        i0.ɵɵtext(16, \"All gifts\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtext(17, \"\\n\");\n        i0.ɵɵelement(18, \"hr\");\n        i0.ɵɵtext(19, \"\\n\");\n        i0.ɵɵelementStart(20, \"p-carousel\", 6);\n        i0.ɵɵtext(21, \"\\n    \");\n        i0.ɵɵtemplate(22, ExchangeComponent_ng_template_22_Template, 43, 4, \"ng-template\", 7);\n        i0.ɵɵtext(23, \"\\n\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtext(24, \"\\n\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtext(25, \"\\n\");\n      }\n      if (rf & 2) {\n        i0.ɵɵadvance(20);\n        i0.ɵɵproperty(\"value\", ctx.gifts)(\"numVisible\", 5)(\"numScroll\", 1);\n      }\n    },\n    dependencies: [i8.NgIf, i9.TranslateDirective, i10.HasAnyAuthorityDirective, i11.Carousel, i3.PrimeTemplate, i12.Card, i13.ButtonDirective, i14.Toast, i4.TranslatePipe],\n    styles: [\".card[_ngcontent-%COMP%]{width:250px;box-shadow:5px 5px 15px 1px #000000ed}.monoton[_ngcontent-%COMP%]{font-family:Monoton,cursive;text-shadow:4px 4px 2px #b00020}.box_yellow[_ngcontent-%COMP%]{background:rgb(252,234,187);background:linear-gradient(to bottom,rgb(252,234,187) 0%,rgb(252,205,77) 50%,rgb(248,181,0) 51%,rgb(251,223,147) 100%);filter:progid:DXImageTransform.Microsoft.gradient(startColorstr=\\\"#fceabb\\\",endColorstr=\\\"#fbdf93\\\",GradientType=0);border-radius:15px;border:2px solid black;padding:10px;box-shadow:4px -4px 15px #ff1f1f,12px -11px 7px #ff9376,20px -5px 7px #ffe264,20px 6px 7px #f6ff33,13px 12px 17px #ff9527,2px 17px 17px red,-9px 21px 18px #fff212,-9px 6px 11px #ff0808,-11px -9px 11px #fffa17,-11px -9px 11px #fffa17,5px 5px 15px 5px #0000}\"]\n  });\n  return ExchangeComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}