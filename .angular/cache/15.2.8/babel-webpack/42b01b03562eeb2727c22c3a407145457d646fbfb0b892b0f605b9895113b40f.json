{"ast":null,"code":"import { PriceType } from \"app/entities/enumerations/price-type.model\";\nimport { EventProductOrderDeleteDialogComponent } from \"app/entities/event-product-order/delete/event-product-order-delete-dialog.component\";\nimport { MessageService } from \"primeng/api\";\nimport * as dayjs from \"dayjs\";\nimport { EventStatus } from 'app/entities/enumerations/event-status.model';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/router\";\nimport * as i2 from \"app/entities/event/service/event.service\";\nimport * as i3 from \"app/general.service\";\nimport * as i4 from \"@ng-bootstrap/ng-bootstrap\";\nimport * as i5 from \"primeng/api\";\nimport * as i6 from \"app/entities/event-product-order/service/event-product-order.service\";\nimport * as i7 from \"@ngx-translate/core\";\nimport * as i8 from \"@angular/forms\";\nimport * as i9 from \"@angular/common\";\nimport * as i10 from \"@fortawesome/angular-fontawesome\";\nimport * as i11 from \"../../shared/language/translate.directive\";\nimport * as i12 from \"primeng/button\";\nimport * as i13 from \"primeng/table\";\nimport * as i14 from \"primeng/toast\";\nimport * as i15 from \"ngx-currency\";\nfunction EditProductsComponent_ng_template_16_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵtext(0, \"\\n          \");\n    i0.ɵɵelementStart(1, \"tr\");\n    i0.ɵɵtext(2, \"\\n              \");\n    i0.ɵɵelementStart(3, \"th\", 12);\n    i0.ɵɵtext(4, \"Productimage\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(5, \"\\n              \");\n    i0.ɵɵelementStart(6, \"th\", 13);\n    i0.ɵɵtext(7, \"Productname\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(8, \"\\n              \");\n    i0.ɵɵelementStart(9, \"th\", 14);\n    i0.ɵɵtext(10, \"Seen\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(11, \"\\n              \");\n    i0.ɵɵelementStart(12, \"th\", 15);\n    i0.ɵɵtext(13, \"Approved\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(14, \"\\n              \");\n    i0.ɵɵelementStart(15, \"th\", 16);\n    i0.ɵɵtext(16, \"Amount\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(17, \"\\n              \");\n    i0.ɵɵelementStart(18, \"th\", 17);\n    i0.ɵɵtext(19, \"Total\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(20, \"\\n              \");\n    i0.ɵɵelementStart(21, \"th\", 18);\n    i0.ɵɵtext(22, \"Selling price\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(23, \"\\n              \");\n    i0.ɵɵelementStart(24, \"th\", 19);\n    i0.ɵɵtext(25, \"Rent date\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(26, \"\\n              \");\n    i0.ɵɵelementStart(27, \"th\", 20);\n    i0.ɵɵtext(28, \"Action\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(29, \"\\n          \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(30, \"\\n      \");\n  }\n}\nfunction EditProductsComponent_ng_template_18_tr_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"tr\");\n    i0.ɵɵtext(1, \"\\n              \");\n    i0.ɵɵelementStart(2, \"td\", 21);\n    i0.ɵɵtext(3, \"\\n                  \");\n    i0.ɵɵelement(4, \"button\", 22);\n    i0.ɵɵtext(5, \"\\n                  \");\n    i0.ɵɵelementStart(6, \"span\", 23);\n    i0.ɵɵtext(7);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(8, \"\\n              \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(9, \"\\n          \");\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r9 = i0.ɵɵnextContext();\n    const eventProductOrder_r4 = ctx_r9.$implicit;\n    const expanded_r7 = ctx_r9.expanded;\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"pRowToggler\", eventProductOrder_r4)(\"icon\", expanded_r7 ? \"pi pi-chevron-down\" : \"pi pi-chevron-right\");\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(eventProductOrder_r4.product.productType);\n  }\n}\nfunction EditProductsComponent_ng_template_18_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵtext(0, \"\\n          \");\n    i0.ɵɵtemplate(1, EditProductsComponent_ng_template_18_tr_1_Template, 10, 3, \"tr\", 11);\n    i0.ɵɵtext(2, \"\\n      \");\n  }\n  if (rf & 2) {\n    const eventProductOrder_r4 = ctx.$implicit;\n    const rowIndex_r5 = ctx.rowIndex;\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.rowGroupMetadata[eventProductOrder_r4.product.productType].index === rowIndex_r5);\n  }\n}\nfunction EditProductsComponent_ng_template_20_div_5_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r22 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵtext(1, \"\\n                  \");\n    i0.ɵɵelementStart(2, \"a\", 26);\n    i0.ɵɵlistener(\"click\", function EditProductsComponent_ng_template_20_div_5_Template_a_click_2_listener() {\n      i0.ɵɵrestoreView(_r22);\n      const eventProductOrder_r10 = i0.ɵɵnextContext().$implicit;\n      const ctx_r20 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r20.openFile(eventProductOrder_r10.product == null ? null : eventProductOrder_r10.product.photoContentType, eventProductOrder_r10.product == null ? null : eventProductOrder_r10.product.photo));\n    });\n    i0.ɵɵtext(3, \"\\n                      \");\n    i0.ɵɵelement(4, \"img\", 27);\n    i0.ɵɵtext(5, \"\\n                  \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(6, \"\\n                \");\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const eventProductOrder_r10 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"src\", \"data:\" + eventProductOrder_r10.product.photoContentType + \";base64,\" + eventProductOrder_r10.product.photo, i0.ɵɵsanitizeUrl);\n  }\n}\nfunction EditProductsComponent_ng_template_20_ng_container_13_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵtext(1, \"\\n                  \");\n    i0.ɵɵelement(2, \"fa-icon\", 28);\n    i0.ɵɵtext(3, \"\\n                \");\n    i0.ɵɵelementContainerEnd();\n  }\n}\nfunction EditProductsComponent_ng_template_20_ng_container_15_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵtext(1, \"\\n                    \");\n    i0.ɵɵelement(2, \"fa-icon\", 29);\n    i0.ɵɵtext(3, \"\\n                \");\n    i0.ɵɵelementContainerEnd();\n  }\n}\nfunction EditProductsComponent_ng_template_20_ng_container_20_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵtext(1, \"\\n                  \");\n    i0.ɵɵelement(2, \"fa-icon\", 28);\n    i0.ɵɵtext(3, \"\\n              \");\n    i0.ɵɵelementContainerEnd();\n  }\n}\nfunction EditProductsComponent_ng_template_20_ng_container_22_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵtext(1, \"\\n                  \");\n    i0.ɵɵelement(2, \"fa-icon\", 29);\n    i0.ɵɵtext(3, \"\\n              \");\n    i0.ɵɵelementContainerEnd();\n  }\n}\nfunction EditProductsComponent_ng_template_20_ng_container_42_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵtext(1, \"\\n                  \");\n    i0.ɵɵelementStart(2, \"table\");\n    i0.ɵɵtext(3, \"\\n                    \");\n    i0.ɵɵelementStart(4, \"tr\");\n    i0.ɵɵtext(5, \"\\n                        \");\n    i0.ɵɵelementStart(6, \"td\");\n    i0.ɵɵtext(7);\n    i0.ɵɵpipe(8, \"date\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(9, \"\\n                    \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(10, \"\\n                    \");\n    i0.ɵɵelementStart(11, \"tr\");\n    i0.ɵɵtext(12, \"\\n                        \");\n    i0.ɵɵelementStart(13, \"td\");\n    i0.ɵɵtext(14);\n    i0.ɵɵpipe(15, \"date\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(16, \"\\n                    \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(17, \"\\n                \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(18, \"\\n              \");\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    const eventProductOrder_r10 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵadvance(7);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind2(8, 2, eventProductOrder_r10.dateFrom, \"medium\"));\n    i0.ɵɵadvance(7);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind2(15, 5, eventProductOrder_r10.dateUntil, \"medium\"));\n  }\n}\nfunction EditProductsComponent_ng_template_20_ng_container_47_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r27 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵtext(1, \"\\n                  \");\n    i0.ɵɵelementStart(2, \"button\", 30);\n    i0.ɵɵlistener(\"click\", function EditProductsComponent_ng_template_20_ng_container_47_Template_button_click_2_listener() {\n      i0.ɵɵrestoreView(_r27);\n      const eventProductOrder_r10 = i0.ɵɵnextContext().$implicit;\n      const ctx_r25 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r25.delete(eventProductOrder_r10));\n    });\n    i0.ɵɵtext(3, \"\\n                      \");\n    i0.ɵɵelement(4, \"fa-icon\", 28);\n    i0.ɵɵtext(5, \"\\n                      \");\n    i0.ɵɵelementStart(6, \"span\", 31);\n    i0.ɵɵtext(7, \"Delete\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(8, \"\\n                  \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(9, \"\\n                \");\n    i0.ɵɵelementContainerEnd();\n  }\n}\nconst _c0 = function () {\n  return {\n    prefix: \"CHF \",\n    thousands: \"\\u00B4\",\n    decimal: \".\",\n    inputMode: \"NATURAL\"\n  };\n};\nfunction EditProductsComponent_ng_template_20_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r29 = i0.ɵɵgetCurrentView();\n    i0.ɵɵtext(0, \"\\n          \");\n    i0.ɵɵelementStart(1, \"tr\");\n    i0.ɵɵtext(2, \"\\n              \");\n    i0.ɵɵelementStart(3, \"td\");\n    i0.ɵɵtext(4, \"\\n                \");\n    i0.ɵɵtemplate(5, EditProductsComponent_ng_template_20_div_5_Template, 7, 1, \"div\", 11);\n    i0.ɵɵtext(6, \"\\n              \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(7, \"\\n              \");\n    i0.ɵɵelementStart(8, \"td\");\n    i0.ɵɵtext(9);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(10, \"\\n              \");\n    i0.ɵɵelementStart(11, \"td\");\n    i0.ɵɵtext(12, \"\\n                \");\n    i0.ɵɵtemplate(13, EditProductsComponent_ng_template_20_ng_container_13_Template, 4, 0, \"ng-container\", 11);\n    i0.ɵɵtext(14, \"\\n                \");\n    i0.ɵɵtemplate(15, EditProductsComponent_ng_template_20_ng_container_15_Template, 4, 0, \"ng-container\", 11);\n    i0.ɵɵtext(16, \"\\n                \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(17, \"\\n              \");\n    i0.ɵɵelementStart(18, \"td\");\n    i0.ɵɵtext(19, \"\\n                \");\n    i0.ɵɵtemplate(20, EditProductsComponent_ng_template_20_ng_container_20_Template, 4, 0, \"ng-container\", 11);\n    i0.ɵɵtext(21, \"\\n              \");\n    i0.ɵɵtemplate(22, EditProductsComponent_ng_template_20_ng_container_22_Template, 4, 0, \"ng-container\", 11);\n    i0.ɵɵtext(23, \"\\n              \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(24, \"\\n              \");\n    i0.ɵɵelementStart(25, \"td\");\n    i0.ɵɵtext(26, \"\\n                  \");\n    i0.ɵɵelementStart(27, \"input\", 24);\n    i0.ɵɵlistener(\"blur\", function EditProductsComponent_ng_template_20_Template_input_blur_27_listener($event) {\n      const restoredCtx = i0.ɵɵrestoreView(_r29);\n      const eventProductOrder_r10 = restoredCtx.$implicit;\n      const ctx_r28 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r28.onBlurAmountEvent($event, eventProductOrder_r10.id));\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(28);\n    i0.ɵɵpipe(29, \"translate\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(30, \"\\n              \");\n    i0.ɵɵelementStart(31, \"td\");\n    i0.ɵɵtext(32);\n    i0.ɵɵpipe(33, \"currency\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(34, \"\\n              \");\n    i0.ɵɵelementStart(35, \"td\");\n    i0.ɵɵtext(36, \"\\n                \");\n    i0.ɵɵelementStart(37, \"input\", 25);\n    i0.ɵɵlistener(\"blur\", function EditProductsComponent_ng_template_20_Template_input_blur_37_listener($event) {\n      const restoredCtx = i0.ɵɵrestoreView(_r29);\n      const eventProductOrder_r10 = restoredCtx.$implicit;\n      const ctx_r30 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r30.onBlurEvent($event, eventProductOrder_r10.id));\n    })(\"ngModelChange\", function EditProductsComponent_ng_template_20_Template_input_ngModelChange_37_listener($event) {\n      const restoredCtx = i0.ɵɵrestoreView(_r29);\n      const eventProductOrder_r10 = restoredCtx.$implicit;\n      return i0.ɵɵresetView(eventProductOrder_r10.sellingPrice = $event);\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(38, \"\\n              \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(39, \"\\n              \");\n    i0.ɵɵelementStart(40, \"td\");\n    i0.ɵɵtext(41, \"\\n                \");\n    i0.ɵɵtemplate(42, EditProductsComponent_ng_template_20_ng_container_42_Template, 19, 8, \"ng-container\", 11);\n    i0.ɵɵtext(43, \"\\n              \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(44, \"\\n              \");\n    i0.ɵɵelementStart(45, \"td\");\n    i0.ɵɵtext(46, \"\\n                \");\n    i0.ɵɵtemplate(47, EditProductsComponent_ng_template_20_ng_container_47_Template, 10, 0, \"ng-container\", 11);\n    i0.ɵɵtext(48, \"\\n              \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(49, \"\\n          \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(50, \"\\n      \");\n  }\n  if (rf & 2) {\n    const eventProductOrder_r10 = ctx.$implicit;\n    i0.ɵɵadvance(5);\n    i0.ɵɵproperty(\"ngIf\", eventProductOrder_r10.product.photo);\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate1(\"\\n                \", eventProductOrder_r10.product.title, \"\\n              \");\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngIf\", eventProductOrder_r10.seen === null || eventProductOrder_r10.seen === false);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", eventProductOrder_r10.seen === true);\n    i0.ɵɵadvance(5);\n    i0.ɵɵproperty(\"ngIf\", eventProductOrder_r10.approved === null || eventProductOrder_r10.approved === false);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", eventProductOrder_r10.approved === true);\n    i0.ɵɵadvance(5);\n    i0.ɵɵpropertyInterpolate1(\"id\", \"change-amount--\", eventProductOrder_r10.id, \"\");\n    i0.ɵɵproperty(\"disabled\", eventProductOrder_r10.approved)(\"value\", eventProductOrder_r10.amount);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", i0.ɵɵpipeBind1(29, 16, \"createyoureventApp.Unit.\" + eventProductOrder_r10.product.unit), \"\\n              \");\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate1(\"\\n                \", i0.ɵɵpipeBind1(33, 18, eventProductOrder_r10.total), \"\\n              \");\n    i0.ɵɵadvance(5);\n    i0.ɵɵproperty(\"options\", i0.ɵɵpureFunction0(20, _c0))(\"disabled\", eventProductOrder_r10.approved)(\"ngModel\", eventProductOrder_r10.sellingPrice);\n    i0.ɵɵadvance(5);\n    i0.ɵɵproperty(\"ngIf\", eventProductOrder_r10.product.priceType === \"RENT\");\n    i0.ɵɵadvance(5);\n    i0.ɵɵproperty(\"ngIf\", eventProductOrder_r10.approved !== true);\n  }\n}\nfunction EditProductsComponent_ng_container_34_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r33 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵtext(1, \"\\n  \");\n    i0.ɵɵelementStart(2, \"button\", 32);\n    i0.ɵɵlistener(\"click\", function EditProductsComponent_ng_container_34_Template_button_click_2_listener() {\n      i0.ɵɵrestoreView(_r33);\n      const ctx_r32 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r32.addProduct());\n    });\n    i0.ɵɵtext(3, \"\\n    \");\n    i0.ɵɵelement(4, \"fa-icon\", 33);\n    i0.ɵɵtext(5, \"\\n    \");\n    i0.ɵɵelementStart(6, \"span\", 34);\n    i0.ɵɵtext(7, \"\\n      Add product\\n    \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(8, \"\\n  \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(9, \"\\n\");\n    i0.ɵɵelementContainerEnd();\n  }\n}\nexport class EditProductsComponent {\n  constructor(route, jhiEventService, generalService, modalService, router, messageService, eventOrderProductService, translate) {\n    this.route = route;\n    this.jhiEventService = jhiEventService;\n    this.generalService = generalService;\n    this.modalService = modalService;\n    this.router = router;\n    this.messageService = messageService;\n    this.eventOrderProductService = eventOrderProductService;\n    this.translate = translate;\n    this.eventProductOrders = [];\n  }\n  ngOnDestroy() {}\n  ngOnInit() {\n    const eventId = this.route.snapshot.params['eventId'];\n    this.jhiEventService.find(eventId).subscribe(ev => {\n      this.jhiEvent = ev.body;\n      this.generalService.findEventProductOrdersByEventId(this.jhiEvent.id).subscribe(epos => {\n        this.eventProductOrders = epos.body;\n        this.updateRowGroupMetaData();\n      });\n    });\n  }\n  onSort() {\n    this.updateRowGroupMetaData();\n  }\n  showAddProductButton() {\n    let show = false;\n    const eventDateStart = dayjs(this.jhiEvent.dateStart);\n    if (this.jhiEvent.definitelyConfirmed === false && this.jhiEvent.status === EventStatus.PROCESSING) {\n      show = true;\n    }\n    return show;\n  }\n  updateRowGroupMetaData() {\n    this.rowGroupMetadata = {};\n    if (this.eventProductOrders) {\n      for (let i = 0; i < this.eventProductOrders.length; i++) {\n        const rowData = this.eventProductOrders[i];\n        const productType = rowData.shop.productType;\n        if (i === 0) {\n          this.rowGroupMetadata[productType] = {\n            index: 0,\n            size: 1\n          };\n        } else {\n          const previousRowData = this.eventProductOrders[i - 1];\n          const previousRowGroup = previousRowData.shop.productType;\n          if (productType === previousRowGroup) this.rowGroupMetadata[productType].size++;else this.rowGroupMetadata[productType] = {\n            index: i,\n            size: 1\n          };\n        }\n      }\n    }\n  }\n  delete(eventProductOrder) {\n    const modalRef = this.modalService.open(EventProductOrderDeleteDialogComponent, {\n      size: 'lg',\n      backdrop: 'static'\n    });\n    modalRef.componentInstance.eventProductOrder = eventProductOrder;\n    modalRef.result.then(() => {\n      this.ngOnInit();\n    });\n  }\n  onBlurEvent(event, id) {\n    this.eventOrderProductService.find(id).subscribe(epo => {\n      const epob = epo.body;\n      epob.sellingPrice = Number(event.target.value.substring(4));\n      if (epob.sellingPrice <= 0) {\n        this.messageService.add({\n          key: 'myKey1',\n          severity: 'error',\n          summary: this.translate.instant('edit-products.error'),\n          detail: this.translate.instant('edit-products.not-allowed-selling-price')\n        });\n        return;\n      }\n      this.eventOrderProductService.update(epob).subscribe(e => {\n        const ep = e.body;\n        this.messageService.add({\n          key: 'myKey1',\n          severity: 'success',\n          summary: this.translate.instant('edit-products.success'),\n          detail: this.translate.instant('edit-products.selling-price-updated')\n        });\n      });\n    });\n  }\n  onBlurAmountEvent(event, id) {\n    this.eventOrderProductService.find(id).subscribe(epo => {\n      const epob = epo.body;\n      const amountOld = epob.amount;\n      const amountNew = event.target.value;\n      let diff_old_new = amountNew - amountOld;\n      if (diff_old_new < 0) {\n        diff_old_new *= -1;\n      }\n      if (amountNew <= 0) {\n        this.messageService.add({\n          key: 'myKey1',\n          severity: 'error',\n          summary: this.translate.instant('edit-products.error'),\n          detail: this.translate.instant('edit-products.not-allowed-amount')\n        });\n        return;\n      }\n      if (amountOld === amountNew) {\n        this.messageService.add({\n          key: 'myKey1',\n          severity: 'success',\n          summary: this.translate.instant('edit-products.success'),\n          detail: this.translate.instant('edit-products.product-updated')\n        });\n        return;\n      }\n      if (epob.product.priceType === PriceType.SELL && epob.product.stock >= 0) {\n        epob.amount = amountNew;\n        epob.total = amountNew * epob.product.price;\n        this.eventOrderProductService.update(epob).subscribe(e => {\n          const ep = e.body;\n          this.messageService.add({\n            key: 'myKey1',\n            severity: 'success',\n            summary: this.translate.instant('edit-products.success'),\n            detail: this.translate.instant('edit-products.product-updated')\n          });\n        });\n      } else if (epob.product.priceType === PriceType.RENT && epob.product.stock >= 0) {\n        const dateFrom = dayjs(epob.dateFrom);\n        const dateUntil = dayjs(epob.dateUntil);\n        if (!dateFrom.isValid() || !dateUntil.isValid()) {\n          this.messageService.add({\n            key: 'myKey1',\n            severity: 'error',\n            summary: this.translate.instant('select-products.error'),\n            detail: this.translate.instant('select-products.error-date')\n          });\n          return;\n        }\n        let arr1 = [];\n        let arr2 = [];\n        let arr3 = [];\n        let arr4 = [];\n        this.generalService.findAllEventProductOrdersWithDateFromRange(dateFrom, dateUntil).subscribe(epo1 => {\n          arr1 = epo1.body;\n          this.generalService.findAllEventProductOrdersWithDateFromSmallerThenAndDateUntilBetween(dateFrom, dateUntil).subscribe(epo2 => {\n            arr2 = epo2.body;\n            this.generalService.findAllEventProductOrdersWithDateFromBetweenAndDateUntilBiggerThen(dateFrom, dateUntil).subscribe(epo3 => {\n              arr3 = epo3.body;\n              this.generalService.findAllEventProductOrdersWithDateFromSmallerThenAndDateUntilBiggerThenAndOnSameTimeRange(dateFrom, dateUntil).subscribe(epo4 => {\n                arr4 = epo4.body;\n                const arrFinal = arr1.concat(arr2).concat(arr3).concat(arr4);\n                const arrUnique = this.getUniqueListBy(arrFinal, 'id');\n                let t = 0;\n                arrUnique.forEach(element => {\n                  t += element.amount;\n                });\n                if (epob.product.stock - t - diff_old_new < 0) {\n                  this.messageService.add({\n                    key: 'myKey1',\n                    severity: 'error',\n                    summary: this.translate.instant('edit-products.error'),\n                    detail: this.translate.instant('edit-products.not-enought-quantity-in-time')\n                  });\n                  return;\n                }\n                epob.amount = amountNew;\n                epob.total = amountNew * epob.product.price;\n                this.eventOrderProductService.update(epob).subscribe(() => {\n                  this.messageService.add({\n                    key: 'myKey1',\n                    severity: 'success',\n                    summary: this.translate.instant('edit-products.successful'),\n                    detail: this.translate.instant('edit-products.product-updated')\n                  });\n                });\n              });\n            });\n          });\n        });\n      }\n    });\n  }\n  getUniqueListBy(arr, key) {\n    return [...new Map(arr.map(item => [item[key], item])).values()];\n  }\n  addProduct() {\n    this.router.navigate(['/events/' + this.jhiEvent.id + '/add-product']);\n  }\n  previousState() {\n    this.router.navigate(['/events/' + this.jhiEvent.id + '/edit']);\n  }\n}\nEditProductsComponent.ɵfac = function EditProductsComponent_Factory(t) {\n  return new (t || EditProductsComponent)(i0.ɵɵdirectiveInject(i1.ActivatedRoute), i0.ɵɵdirectiveInject(i2.EventService), i0.ɵɵdirectiveInject(i3.GeneralService), i0.ɵɵdirectiveInject(i4.NgbModal), i0.ɵɵdirectiveInject(i1.Router), i0.ɵɵdirectiveInject(i5.MessageService), i0.ɵɵdirectiveInject(i6.EventProductOrderService), i0.ɵɵdirectiveInject(i7.TranslateService));\n};\nEditProductsComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: EditProductsComponent,\n  selectors: [[\"jhi-edit-products\"]],\n  features: [i0.ɵɵProvidersFeature([MessageService])],\n  decls: 36,\n  vars: 11,\n  consts: [[\"key\", \"myKey1\"], [1, \"card\"], [\"jhiTranslate\", \"edit-products.edit-product-for\"], [\"jhiTranslate\", \"edit-products.from\"], [\"sortField\", \"shop.productType\", \"sortMode\", \"single\", \"dataKey\", \"shop.productType\", 3, \"value\", \"onSort\"], [\"pTemplate\", \"header\"], [\"pTemplate\", \"body\"], [\"pTemplate\", \"rowexpansion\"], [\"type\", \"submit\", 1, \"btn\", \"btn-info\", 3, \"click\"], [\"icon\", \"arrow-left\"], [\"jhiTranslate\", \"entity.action.back\"], [4, \"ngIf\"], [\"jhiTranslate\", \"edit-products.product-image\"], [\"jhiTranslate\", \"edit-products.product-name\"], [\"jhiTranslate\", \"edit-products.seen\"], [\"jhiTranslate\", \"edit-products.approved\"], [\"jhiTranslate\", \"edit-products.amount\"], [\"jhiTranslate\", \"edit-products.total\"], [\"jhiTranslate\", \"edit-products.selling-price\"], [\"jhiTranslate\", \"edit-products.rent-date\"], [\"jhiTranslate\", \"edit-products.action\"], [\"colspan\", \"9\"], [\"type\", \"button\", \"pButton\", \"\", \"pRipple\", \"\", 1, \"p-button-text\", \"p-button-rounded\", \"p-button-plain\", \"p-mr-2\", 3, \"pRowToggler\", \"icon\"], [1, \"p-text-bold\", \"p-ml-2\", 2, \"font-weight\", \"bold\"], [\"type\", \"number\", 1, \"amount-input\", 3, \"disabled\", \"value\", \"id\", \"blur\"], [\"currencyMask\", \"\", 1, \"selling-price-input\", 3, \"options\", \"disabled\", \"ngModel\", \"blur\", \"ngModelChange\"], [3, \"click\"], [\"alt\", \"product image\", 2, \"max-width\", \"100px\", 3, \"src\"], [\"icon\", \"times\"], [\"icon\", \"check\"], [\"type\", \"submit\", 1, \"btn\", \"btn-danger\", \"btn-sm\", 3, \"click\"], [\"jhiTranslate\", \"entity.action.delete\", 1, \"d-none\", \"d-md-inline\"], [1, \"btn\", \"btn-info\", 3, \"click\"], [\"icon\", \"plus\"], [\"jhiTranslate\", \"edit-products.add-product\"]],\n  template: function EditProductsComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelement(0, \"p-toast\", 0);\n      i0.ɵɵtext(1, \"\\n\");\n      i0.ɵɵelementStart(2, \"div\", 1);\n      i0.ɵɵtext(3, \"\\n  \");\n      i0.ɵɵelementStart(4, \"h5\")(5, \"span\", 2);\n      i0.ɵɵtext(6, \"Edit product for \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(7);\n      i0.ɵɵelementStart(8, \"span\", 3);\n      i0.ɵɵtext(9, \"from\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(10);\n      i0.ɵɵpipe(11, \"date\");\n      i0.ɵɵpipe(12, \"date\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(13, \"\\n  \");\n      i0.ɵɵelementStart(14, \"p-table\", 4);\n      i0.ɵɵlistener(\"onSort\", function EditProductsComponent_Template_p_table_onSort_14_listener() {\n        return ctx.onSort();\n      });\n      i0.ɵɵtext(15, \"\\n      \");\n      i0.ɵɵtemplate(16, EditProductsComponent_ng_template_16_Template, 31, 0, \"ng-template\", 5);\n      i0.ɵɵtext(17, \"\\n      \");\n      i0.ɵɵtemplate(18, EditProductsComponent_ng_template_18_Template, 3, 1, \"ng-template\", 6);\n      i0.ɵɵtext(19, \"\\n      \");\n      i0.ɵɵtemplate(20, EditProductsComponent_ng_template_20_Template, 51, 21, \"ng-template\", 7);\n      i0.ɵɵtext(21, \"\\n  \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(22, \"\\n\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(23, \"\\n\");\n      i0.ɵɵelement(24, \"hr\");\n      i0.ɵɵtext(25, \"\\n\\n\");\n      i0.ɵɵelementStart(26, \"button\", 8);\n      i0.ɵɵlistener(\"click\", function EditProductsComponent_Template_button_click_26_listener() {\n        return ctx.previousState();\n      });\n      i0.ɵɵtext(27, \"\\n  \");\n      i0.ɵɵelement(28, \"fa-icon\", 9);\n      i0.ɵɵtext(29, \"\\u00A0\");\n      i0.ɵɵelementStart(30, \"span\", 10);\n      i0.ɵɵtext(31, \"Back\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(32, \"\\n\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(33, \"\\n\\n\");\n      i0.ɵɵtemplate(34, EditProductsComponent_ng_container_34_Template, 10, 0, \"ng-container\", 11);\n      i0.ɵɵtext(35, \"\\n\");\n    }\n    if (rf & 2) {\n      i0.ɵɵadvance(7);\n      i0.ɵɵtextInterpolate1(\"\", ctx.jhiEvent.name, \" \");\n      i0.ɵɵadvance(3);\n      i0.ɵɵtextInterpolate2(\"\", i0.ɵɵpipeBind2(11, 5, ctx.jhiEvent.dateStart, \"medium\"), \" - \", i0.ɵɵpipeBind2(12, 8, ctx.jhiEvent.dateEnd, \"medium\"), \"\");\n      i0.ɵɵadvance(4);\n      i0.ɵɵproperty(\"value\", ctx.eventProductOrders);\n      i0.ɵɵadvance(20);\n      i0.ɵɵproperty(\"ngIf\", ctx.showAddProductButton());\n    }\n  },\n  dependencies: [i5.PrimeTemplate, i8.DefaultValueAccessor, i8.NgControlStatus, i8.NgModel, i9.NgIf, i10.FaIconComponent, i11.TranslateDirective, i12.ButtonDirective, i13.Table, i13.RowToggler, i14.Toast, i15.CurrencyMaskDirective, i9.CurrencyPipe, i9.DatePipe, i7.TranslatePipe],\n  styles: [\".amount-input[_ngcontent-%COMP%] {\\n  width: 100px;\\n}\\n\\n.selling-price-input[_ngcontent-%COMP%] {\\n  width: 100px;\\n}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9tYWluL3dlYmFwcC9hcHAvdmlld3MvZXZlbnQvZWRpdC1wcm9kdWN0cy5jb21wb25lbnQuc2NzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNJLFlBQUE7QUFDSjs7QUFFQTtFQUNFLFlBQUE7QUFDRiIsInNvdXJjZXNDb250ZW50IjpbIi5hbW91bnQtaW5wdXQge1xuICAgIHdpZHRoOiAxMDBweDtcbn1cblxuLnNlbGxpbmctcHJpY2UtaW5wdXQge1xuICB3aWR0aDogMTAwcHg7XG59XG4iXSwic291cmNlUm9vdCI6IiJ9 */\"]\n});","map":{"version":3,"mappings":"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","names":["PriceType","EventProductOrderDeleteDialogComponent","MessageService","dayjs","EventStatus","i0","EditProductsComponent","constructor","route","jhiEventService","generalService","modalService","router","messageService","eventOrderProductService","translate","ngOnDestroy","ngOnInit","eventId","snapshot","params","find","subscribe","ev","jhiEvent","body","findEventProductOrdersByEventId","id","epos","eventProductOrders","updateRowGroupMetaData","onSort","showAddProductButton","show","eventDateStart","dateStart","definitelyConfirmed","status","PROCESSING","rowGroupMetadata","i","length","rowData","productType","shop","index","size","previousRowData","previousRowGroup","delete","eventProductOrder","modalRef","open","backdrop","componentInstance","result","then","onBlurEvent","event","epo","epob","sellingPrice","Number","target","value","substring","add","key","severity","summary","instant","detail","update","e","ep","onBlurAmountEvent","amountOld","amount","amountNew","diff_old_new","product","priceType","SELL","stock","total","price","RENT","dateFrom","dateUntil","isValid","arr1","arr2","arr3","arr4","findAllEventProductOrdersWithDateFromRange","epo1","findAllEventProductOrdersWithDateFromSmallerThenAndDateUntilBetween","epo2","findAllEventProductOrdersWithDateFromBetweenAndDateUntilBiggerThen","epo3","findAllEventProductOrdersWithDateFromSmallerThenAndDateUntilBiggerThenAndOnSameTimeRange","epo4","arrFinal","concat","arrUnique","getUniqueListBy","t","forEach","element","arr","Map","map","item","values","addProduct","navigate","previousState","selectors","features","decls","vars","consts","template","ctx"],"sourceRoot":"","sources":["/home/ceo/mmmm/createyourevent/src/main/webapp/app/views/event/edit-products.component.ts","/home/ceo/mmmm/createyourevent/src/main/webapp/app/views/event/edit-products.component.html"],"sourcesContent":["import { FormGroup, FormArray, FormControl } from '@angular/forms';\nimport { Component, OnInit, OnDestroy, ViewChild, ElementRef } from \"@angular/core\";\nimport { ActivatedRoute, Router } from \"@angular/router\";\nimport { NgbModal } from \"@ng-bootstrap/ng-bootstrap\";\nimport { TranslateService } from \"@ngx-translate/core\";\nimport { PriceType } from \"app/entities/enumerations/price-type.model\";\nimport { EventProductOrderDeleteDialogComponent } from \"app/entities/event-product-order/delete/event-product-order-delete-dialog.component\";\nimport { IEventProductOrder } from \"app/entities/event-product-order/event-product-order.model\";\nimport { EventProductOrderService } from \"app/entities/event-product-order/service/event-product-order.service\";\nimport { IEvent } from \"app/entities/event/event.model\";\nimport { EventService } from \"app/entities/event/service/event.service\";\nimport { GeneralService } from \"app/general.service\";\nimport { MessageService } from \"primeng/api\";\nimport * as dayjs from \"dayjs\";\nimport { EventStatus } from 'app/entities/enumerations/event-status.model';\nimport { IProduct } from 'app/entities/product/product.model';\n\n\n@Component({\n  selector: 'jhi-edit-products',\n  templateUrl: './edit-products.component.html',\n  styleUrls: ['edit-products.component.scss'],\n  providers: [MessageService]\n})\nexport class EditProductsComponent implements OnInit, OnDestroy {\n\n  jhiEvent!: IEvent;\n\n  eventProductOrders: IEventProductOrder[] = [];\n  rowGroupMetadata: any;\n\n  constructor(\n    private route: ActivatedRoute,\n    protected jhiEventService: EventService,\n    private generalService: GeneralService,\n    protected modalService: NgbModal,\n    private router: Router,\n    private messageService: MessageService,\n    private eventOrderProductService: EventProductOrderService,\n    private translate: TranslateService\n  ) {}\n\n\n  ngOnDestroy(): void {}\n\n  ngOnInit(): void {\n    const eventId = this.route.snapshot.params['eventId'];\n    this.jhiEventService.find(eventId).subscribe(ev => {\n      this.jhiEvent = ev.body!;\n      this.generalService.findEventProductOrdersByEventId(this.jhiEvent.id!).subscribe(epos => {\n        this.eventProductOrders = epos.body!;\n        this.updateRowGroupMetaData();\n      });\n    });\n  }\n\n  onSort(): void {\n    this.updateRowGroupMetaData();\n  }\n\n  showAddProductButton(): boolean  {\n    let show = false;\n    const eventDateStart = dayjs(this.jhiEvent.dateStart);\n    if(this.jhiEvent.definitelyConfirmed === false && this.jhiEvent.status === EventStatus.PROCESSING) {\n      show = true;\n    }\n    return show;\n  }\n\n  updateRowGroupMetaData(): void {\n    this.rowGroupMetadata = {};\n\n    if (this.eventProductOrders) {\n        for (let i = 0; i < this.eventProductOrders.length; i++) {\n            const rowData = this.eventProductOrders[i];\n            const productType = rowData.shop!.productType;\n\n            if (i === 0) {\n                this.rowGroupMetadata[productType!] = { index: 0, size: 1 };\n            }\n            else {\n                const previousRowData = this.eventProductOrders[i - 1];\n                const previousRowGroup = previousRowData.shop!.productType;\n                if (productType === previousRowGroup)\n                    this.rowGroupMetadata[productType!].size++;\n                else\n                    this.rowGroupMetadata[productType!] = { index: i, size: 1 };\n            }\n        }\n    }\n  }\n\n  delete(eventProductOrder: IEventProductOrder): void {\n    const modalRef = this.modalService.open(EventProductOrderDeleteDialogComponent, { size: 'lg', backdrop: 'static' });\n    modalRef.componentInstance.eventProductOrder = eventProductOrder;\n\n    modalRef.result.then(() => {\n      this.ngOnInit();\n    });\n  }\n\n  onBlurEvent(event: any, id: number): void{\n    this.eventOrderProductService.find(id).subscribe(epo => {\n      const epob = epo.body;\n      epob.sellingPrice = Number(event.target.value.substring(4));\n      if(epob.sellingPrice <= 0) {\n        this.messageService.add({ key: 'myKey1', severity: 'error', summary: this.translate.instant('edit-products.error'), detail: this.translate.instant('edit-products.not-allowed-selling-price') });\n        return;\n      }\n\n      this.eventOrderProductService.update(epob).subscribe(e => {\n        const ep = e.body;\n        this.messageService.add({ key: 'myKey1', severity: 'success', summary: this.translate.instant('edit-products.success'), detail: this.translate.instant('edit-products.selling-price-updated') });\n        });\n    });\n }\n\n onBlurAmountEvent(event: any, id: number): void{\n  this.eventOrderProductService.find(id).subscribe(epo => {\n    const epob = epo.body;\n    const amountOld = epob.amount;\n    const amountNew = event.target.value;\n    let diff_old_new = amountNew - amountOld;\n    if(diff_old_new < 0) {\n      diff_old_new *= -1;\n    }\n\n    if(amountNew <= 0) {\n      this.messageService.add({ key: 'myKey1', severity: 'error', summary: this.translate.instant('edit-products.error'), detail: this.translate.instant('edit-products.not-allowed-amount') });\n      return;\n    }\n\n    if(amountOld === amountNew) {\n      this.messageService.add({ key: 'myKey1', severity: 'success', summary: this.translate.instant('edit-products.success'), detail: this.translate.instant('edit-products.product-updated') });\n      return;\n    }\n\n    if(epob.product.priceType === PriceType.SELL && epob.product.stock >= 0) {\n      epob.amount = amountNew;\n      epob.total = amountNew * epob.product.price;\n      this.eventOrderProductService.update(epob).subscribe(e => {\n        const ep = e.body;\n        this.messageService.add({ key: 'myKey1', severity: 'success', summary: this.translate.instant('edit-products.success'), detail: this.translate.instant('edit-products.product-updated') });\n        });\n    } else if(epob.product!.priceType === PriceType.RENT && epob.product.stock >= 0) {\n\n      const dateFrom = dayjs(epob.dateFrom!);\n      const dateUntil = dayjs(epob.dateUntil!);\n\n      if (!dateFrom.isValid() || !dateUntil.isValid()) {\n        this.messageService.add({ key: 'myKey1', severity: 'error', summary: this.translate.instant('select-products.error'), detail: this.translate.instant('select-products.error-date') });\n        return;\n      }\n\n      let arr1: IEventProductOrder[] = [];\n      let arr2: IEventProductOrder[] = [];\n      let arr3: IEventProductOrder[] = [];\n      let arr4: IEventProductOrder[] = [];\n      this.generalService.findAllEventProductOrdersWithDateFromRange(dateFrom, dateUntil).subscribe(epo1 => {\n        arr1 = epo1.body!;\n        this.generalService.findAllEventProductOrdersWithDateFromSmallerThenAndDateUntilBetween(dateFrom, dateUntil).subscribe(epo2 => {\n          arr2 = epo2.body!;\n          this.generalService.findAllEventProductOrdersWithDateFromBetweenAndDateUntilBiggerThen(dateFrom, dateUntil).subscribe(epo3 => {\n            arr3 = epo3.body!;\n            this.generalService.findAllEventProductOrdersWithDateFromSmallerThenAndDateUntilBiggerThenAndOnSameTimeRange(dateFrom, dateUntil).subscribe(epo4 => {\n              arr4 = epo4.body!;\n\n              const arrFinal = arr1.concat(arr2).concat(arr3).concat(arr4);\n              const arrUnique = this.getUniqueListBy(arrFinal, 'id');\n\n              let t = 0;\n              arrUnique.forEach(element => {\n                t += element.amount!;\n              });\n\n              if (epob.product!.stock! - t - diff_old_new < 0) {\n                this.messageService.add({ key: 'myKey1', severity: 'error', summary: this.translate.instant('edit-products.error'), detail: this.translate.instant('edit-products.not-enought-quantity-in-time') });\n                return;\n              }\n\n              epob.amount = amountNew;\n              epob.total = amountNew * epob.product!.price!;\n              this.eventOrderProductService.update(epob).subscribe(() => {\n              this.messageService.add({ key: 'myKey1', severity: 'success', summary: this.translate.instant('edit-products.successful'), detail: this.translate.instant('edit-products.product-updated') });\n              });\n\n\n            });\n          });\n        });\n      });\n    }\n  });\n}\n\n  getUniqueListBy(arr: any[], key: any): IEventProductOrder[] {\n    return [...new Map(arr.map(item => [item[key], item])).values()]\n  }\n\n  addProduct(): void {\n    this.router.navigate(['/events/' + this.jhiEvent.id + '/add-product']);\n  }\n\n  previousState(): void {\n    this.router.navigate(['/events/' + this.jhiEvent.id + '/edit']);\n  }\n}\n","<p-toast key=\"myKey1\"></p-toast>\n<div class=\"card\">\n  <h5><span jhiTranslate=\"edit-products.edit-product-for\">Edit product for </span>{{ jhiEvent.name }} <span jhiTranslate=\"edit-products.from\">from</span>{{ jhiEvent.dateStart | date: 'medium' }} - {{ jhiEvent.dateEnd | date: 'medium' }}</h5>\n  <p-table [value]=\"eventProductOrders\" sortField=\"shop.productType\" sortMode=\"single\" (onSort)=\"onSort()\" dataKey=\"shop.productType\">\n      <ng-template pTemplate=\"header\">\n          <tr>\n              <th jhiTranslate=\"edit-products.product-image\">Productimage</th>\n              <th jhiTranslate=\"edit-products.product-name\">Productname</th>\n              <th jhiTranslate=\"edit-products.seen\">Seen</th>\n              <th jhiTranslate=\"edit-products.approved\">Approved</th>\n              <th jhiTranslate=\"edit-products.amount\">Amount</th>\n              <th jhiTranslate=\"edit-products.total\">Total</th>\n              <th jhiTranslate=\"edit-products.selling-price\">Selling price</th>\n              <th jhiTranslate=\"edit-products.rent-date\">Rent date</th>\n              <th jhiTranslate=\"edit-products.action\">Action</th>\n          </tr>\n      </ng-template>\n      <ng-template pTemplate=\"body\" let-eventProductOrder let-rowIndex=\"rowIndex\" let-columns=\"columns\" let-expanded=\"expanded\">\n          <tr *ngIf=\"rowGroupMetadata[eventProductOrder.product.productType].index === rowIndex\">\n              <td colspan=\"9\">\n                  <button type=\"button\" pButton pRipple [pRowToggler]=\"eventProductOrder\" class=\"p-button-text p-button-rounded p-button-plain p-mr-2\" [icon]=\"expanded ? 'pi pi-chevron-down' : 'pi pi-chevron-right'\"></button>\n                  <span style=\"font-weight:bold\" class=\"p-text-bold p-ml-2\">{{ eventProductOrder.product.productType }}</span>\n              </td>\n          </tr>\n      </ng-template>\n      <ng-template pTemplate=\"rowexpansion\" let-eventProductOrder let-columns=\"columns\" let-rowIndex=\"rowIndex\">\n          <tr>\n              <td>\n                <div *ngIf=\"eventProductOrder.product.photo\">\n                  <a (click)=\"openFile(eventProductOrder.product?.photoContentType!, eventProductOrder.product?.photo)\">\n                      <img [src]=\"'data:' + eventProductOrder.product.photoContentType + ';base64,' + eventProductOrder.product.photo\" style=\"max-width: 100px;\" alt=\"product image\"/>\n                  </a>\n                </div>\n              </td>\n              <td>\n                {{ eventProductOrder.product.title }}\n              </td>\n              <td>\n                <ng-container *ngIf=\"eventProductOrder.seen === null || eventProductOrder.seen === false\">\n                  <fa-icon icon=\"times\"></fa-icon>\n                </ng-container>\n                <ng-container *ngIf=\"eventProductOrder.seen  === true\">\n                    <fa-icon icon=\"check\"></fa-icon>\n                </ng-container>\n                </td>\n              <td>\n                <ng-container *ngIf=\"eventProductOrder.approved === null || eventProductOrder.approved === false\">\n                  <fa-icon icon=\"times\"></fa-icon>\n              </ng-container>\n              <ng-container *ngIf=\"eventProductOrder.approved  === true\">\n                  <fa-icon icon=\"check\"></fa-icon>\n              </ng-container>\n              </td>\n              <td>\n                  <input class=\"amount-input\" type=\"number\" (blur)=\"onBlurAmountEvent($event, eventProductOrder.id)\" [disabled]=\"eventProductOrder.approved\" [value]=\"eventProductOrder.amount\" id=\"change-amount--{{ eventProductOrder.id }}\" /> {{ \"createyoureventApp.Unit.\" + eventProductOrder.product.unit  | translate }}\n              </td>\n              <td>\n                {{ eventProductOrder.total | currency }}\n              </td>\n              <td>\n                <input currencyMask (blur)=\"onBlurEvent($event, eventProductOrder.id)\" [options]=\"{ prefix: 'CHF ', thousands: '´', decimal: '.',  inputMode: 'NATURAL' }\"  class=\"selling-price-input\" [disabled]=\"eventProductOrder.approved\" [(ngModel)]=\"eventProductOrder.sellingPrice\" />\n              </td>\n              <td>\n                <ng-container *ngIf=\"eventProductOrder.product.priceType === 'RENT'\">\n                  <table>\n                    <tr>\n                        <td>{{ eventProductOrder.dateFrom | date: 'medium' }}</td>\n                    </tr>\n                    <tr>\n                        <td>{{ eventProductOrder.dateUntil | date: 'medium' }}</td>\n                    </tr>\n                </table>\n              </ng-container>\n              </td>\n              <td>\n                <ng-container *ngIf=\"eventProductOrder.approved  !== true\">\n                  <button type=\"submit\" (click)=\"delete(eventProductOrder)\" class=\"btn btn-danger btn-sm\">\n                      <fa-icon icon=\"times\"></fa-icon>\n                      <span class=\"d-none d-md-inline\" jhiTranslate=\"entity.action.delete\">Delete</span>\n                  </button>\n                </ng-container>\n              </td>\n          </tr>\n      </ng-template>\n  </p-table>\n</div>\n<hr/>\n\n<button type=\"submit\"\n  (click)=\"previousState()\"\n  class=\"btn btn-info\">\n  <fa-icon icon=\"arrow-left\"></fa-icon>&nbsp;<span jhiTranslate=\"entity.action.back\">Back</span>\n</button>\n\n<ng-container *ngIf=\" showAddProductButton()\">\n  <button class=\"btn btn-info\" (click)=\"addProduct()\">\n    <fa-icon icon=\"plus\"></fa-icon>\n    <span  jhiTranslate=\"edit-products.add-product\">\n      Add product\n    </span>\n  </button>\n</ng-container>\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}