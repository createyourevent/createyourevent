{"ast":null,"code":"import * as i0 from \"@angular/core\";\nimport * as i1 from \"app/general.service\";\nimport * as i2 from \"app/organisator/organisator.service\";\nimport * as i3 from \"@angular/common\";\nimport * as i4 from \"primeng/dataview\";\nimport * as i5 from \"primeng/api\";\nimport * as i6 from \"../../../shared/language/translate.directive\";\nimport * as i7 from \"../../type-flags/price-type/price-type.component\";\nimport * as i8 from \"@ngx-translate/core\";\nfunction CrossSellingComponent_ng_container_0_ng_template_9_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵtext(0, \"\\n                \");\n    i0.ɵɵelementStart(1, \"div\", 5);\n    i0.ɵɵtext(2, \"\\n                    \");\n    i0.ɵɵelementStart(3, \"div\", 6);\n    i0.ɵɵtext(4, \"\\n                        \");\n    i0.ɵɵelementStart(5, \"a\", 7);\n    i0.ɵɵtext(6, \"\\n                            \");\n    i0.ɵɵelementStart(7, \"h3\", 8);\n    i0.ɵɵtext(8);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(9, \"\\n                            \");\n    i0.ɵɵelementStart(10, \"div\", 9);\n    i0.ɵɵtext(11, \"\\n                                \");\n    i0.ɵɵelement(12, \"img\", 10);\n    i0.ɵɵtext(13, \"\\n                            \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(14, \"\\n                            \");\n    i0.ɵɵelement(15, \"hr\");\n    i0.ɵɵtext(16, \"\\n                            \");\n    i0.ɵɵelementStart(17, \"div\", 11);\n    i0.ɵɵtext(18, \"\\n                                \");\n    i0.ɵɵelement(19, \"jhi-price-type\", 12);\n    i0.ɵɵtext(20, \"\\n                                \");\n    i0.ɵɵelementStart(21, \"dl\", 13);\n    i0.ɵɵtext(22, \"\\n                                    \");\n    i0.ɵɵelementStart(23, \"dt\")(24, \"span\", 14);\n    i0.ɵɵtext(25, \"Price\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵtext(26, \"\\n                                    \");\n    i0.ɵɵelementStart(27, \"dd\");\n    i0.ɵɵtext(28, \"\\n                                        \");\n    i0.ɵɵelementStart(29, \"span\");\n    i0.ɵɵtext(30);\n    i0.ɵɵpipe(31, \"currency\");\n    i0.ɵɵpipe(32, \"translate\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(33, \"\\n                                    \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(34, \"\\n                                \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(35, \"\\n                            \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(36, \"\\n                        \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(37, \"\\n                    \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(38, \"\\n                \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(39, \"\\n            \");\n  }\n  if (rf & 2) {\n    const product_r2 = ctx.$implicit;\n    i0.ɵɵadvance(5);\n    i0.ɵɵpropertyInterpolate1(\"href\", \"/products/\", product_r2.id, \"/view\", i0.ɵɵsanitizeUrl);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(product_r2.title);\n    i0.ɵɵadvance(4);\n    i0.ɵɵpropertyInterpolate(\"alt\", product_r2.title);\n    i0.ɵɵproperty(\"src\", \"data:\" + product_r2.photoContentType + \";base64,\" + product_r2.photo, i0.ɵɵsanitizeUrl);\n    i0.ɵɵadvance(7);\n    i0.ɵɵproperty(\"product\", product_r2);\n    i0.ɵɵadvance(11);\n    i0.ɵɵtextInterpolate3(\"\", i0.ɵɵpipeBind1(31, 8, product_r2.price), \" / \", product_r2.amount, \" \", i0.ɵɵpipeBind1(32, 10, \"createyoureventApp.Unit.\" + product_r2.unit), \"\");\n  }\n}\nfunction CrossSellingComponent_ng_container_0_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵtext(1, \"\\n    \");\n    i0.ɵɵelementStart(2, \"div\", 1);\n    i0.ɵɵtext(3, \"\\n        \");\n    i0.ɵɵelementStart(4, \"h3\", 2);\n    i0.ɵɵtext(5, \"Customers who bought this also bought ...\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(6, \"\\n        \");\n    i0.ɵɵelementStart(7, \"p-dataView\", 3);\n    i0.ɵɵtext(8, \"\\n            \");\n    i0.ɵɵtemplate(9, CrossSellingComponent_ng_container_0_ng_template_9_Template, 40, 12, \"ng-template\", 4);\n    i0.ɵɵtext(10, \"\\n        \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(11, \"\\n    \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(12, \"\\n\");\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(7);\n    i0.ɵɵproperty(\"value\", ctx_r0.products)(\"paginator\", true)(\"rows\", 8);\n  }\n}\nexport class CrossSellingComponent {\n  constructor(generalService, organisatorService) {\n    this.generalService = generalService;\n    this.organisatorService = organisatorService;\n    this.events = [];\n    this.products = [];\n    this.loaded = false;\n  }\n  ngOnChanges(changes) {\n    if (changes['product'] !== undefined) {\n      this.product = changes['product'].currentValue;\n      this.loadEventProductOrders().then(() => {\n        this.loadEvents().then(() => {\n          this.loadCrossSellingProducts().then(() => {\n            this.loaded = true;\n          });\n        });\n      });\n    }\n  }\n  loadEventProductOrders() {\n    let promise = new Promise((resolve, reject) => {\n      this.generalService.findEventProductOrdersByProductId(this.product.id).toPromise().then(res => {\n        this.eventProductOrders = res.body;\n        resolve();\n      });\n    });\n    return promise;\n  }\n  loadEvents() {\n    let promise = new Promise((resolve, reject) => {\n      this.eventProductOrders.forEach(element => {\n        this.events.push(element.event);\n      });\n      resolve();\n    });\n    return promise;\n  }\n  loadProducts(id) {\n    let promise = new Promise((resolve, reject) => {\n      this.generalService.findEventProductOrdersByEventId(id).toPromise().then(res => {\n        res.body.forEach(epo => {\n          if (epo.id !== this.product.id) {\n            this.products.push(epo.product);\n          }\n        });\n        resolve();\n      });\n    });\n    return promise;\n  }\n  loadCrossSellingProducts() {\n    let promise = new Promise((resolve, reject) => {\n      let i = 0;\n      this.events.forEach(ele => {\n        i++;\n        this.loadProducts(ele.id).then(() => {\n          if (this.events.length === i) {\n            const prodsUnique = this.getUniqueListBy(this.products, 'id');\n            this.products = prodsUnique.sort(() => Math.random() - 0.5);\n            resolve();\n          }\n        });\n      });\n    });\n    return promise;\n  }\n  getUniqueListBy(arr, key) {\n    return [...new Map(arr.map(item => [item[key], item])).values()];\n  }\n}\nCrossSellingComponent.ɵfac = function CrossSellingComponent_Factory(t) {\n  return new (t || CrossSellingComponent)(i0.ɵɵdirectiveInject(i1.GeneralService), i0.ɵɵdirectiveInject(i2.OrganisatorService));\n};\nCrossSellingComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: CrossSellingComponent,\n  selectors: [[\"jhi-cross-selling\"]],\n  inputs: {\n    product: \"product\"\n  },\n  features: [i0.ɵɵNgOnChangesFeature],\n  decls: 2,\n  vars: 1,\n  consts: [[4, \"ngIf\"], [1, \"box_brown\"], [\"jhiTranslate\", \"crossSelling.also-bought\"], [\"layout\", \"grid\", 3, \"value\", \"paginator\", \"rows\"], [\"pTemplate\", \"gridItem\"], [1, \"p-col-12\", \"p-md-3\"], [1, \"card\", \"card-container\"], [3, \"href\"], [1, \"title\"], [1, \"center\"], [2, \"max-height\", \"250px\", \"max-width\", \"250px\", 3, \"src\", \"alt\"], [1, \"star\"], [3, \"product\"], [1, \"row-md\", \"jh-entity-details\", \"price\"], [\"jhiTranslate\", \"product-detail.price\"]],\n  template: function CrossSellingComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵtemplate(0, CrossSellingComponent_ng_container_0_Template, 13, 3, \"ng-container\", 0);\n      i0.ɵɵtext(1, \"\\n\");\n    }\n    if (rf & 2) {\n      i0.ɵɵproperty(\"ngIf\", ctx.loaded);\n    }\n  },\n  dependencies: [i3.NgIf, i4.DataView, i5.PrimeTemplate, i6.TranslateDirective, i7.PriceTypeComponent, i3.CurrencyPipe, i8.TranslatePipe],\n  styles: [\".card[_ngcontent-%COMP%] {\\n  box-shadow: 10px 10px 7px -3px rgba(0, 0, 0, 0.75);\\n  -webkit-box-shadow: 10px 10px 7px -3px rgba(0, 0, 0, 0.75);\\n  -moz-box-shadow: 10px 10px 7px -3px rgba(0, 0, 0, 0.75);\\n  padding: 10px;\\n  \\n  background: rgb(254, 204, 177);   \\n  background: linear-gradient(to bottom, rgb(254, 204, 177) 0%, rgb(241, 116, 50) 50%, rgb(234, 85, 7) 51%, rgb(251, 149, 94) 100%); \\n  filter: progid:DXImageTransform.Microsoft.gradient( startColorstr=\\\"#feccb1\\\", endColorstr=\\\"#fb955e\\\",GradientType=0 ); \\n  height: 600px;\\n  margin: 10px auto;\\n}\\n\\n.center[_ngcontent-%COMP%] {\\n  text-align: center;\\n  margin: 5px auto;\\n}\\n\\n.title[_ngcontent-%COMP%] {\\n  color: black;\\n  font-family: \\\"Knewave\\\", cursive;\\n}\\n\\n.price[_ngcontent-%COMP%] {\\n  color: red;\\n  font-family: \\\"Knewave\\\", cursive;\\n}\\n\\n.star[_ngcontent-%COMP%] {\\n  background-image: url('star_250.png');\\n  background-size: 250px 250px;\\n  background-repeat: repeat-x;\\n  width: 250px;\\n  height: 250px;\\n  margin: 0 auto;\\n  text-align: center;\\n  vertical-align: middle;\\n  padding-top: 30px;\\n}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9tYWluL3dlYmFwcC9hcHAvdmlld3MvcHJvZHVjdC9jcm9zc1NlbGxpbmcvY3Jvc3NTZWxsaW5nLmNvbXBvbmVudC5zY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0VBQ0Usa0RBQUE7RUFDQSwwREFBQTtFQUNBLHVEQUFBO0VBQ0EsYUFBQTtFQUNBLG9KQUFBO0VBQ0EsOEJBQUEsRUFBQSxpQkFBQSxFQU9HLGFBQUEsRUFPQSw0QkFBQTtFQUNILGlJQUFBLEVBTUcscURBQUE7RUFDSCxtSEFBQSxFQUFBLFVBQUE7RUFDQSxhQUFBO0VBQ0EsaUJBQUE7QUFqQkY7O0FBb0JBO0VBQ0Usa0JBQUE7RUFDQSxnQkFBQTtBQWpCRjs7QUFvQkE7RUFDRSxZQUFBO0VBQ0EsK0JBQUE7QUFqQkY7O0FBb0JBO0VBQ0UsVUFBQTtFQUNBLCtCQUFBO0FBakJGOztBQW9CQTtFQUNFLHFDQUFBO0VBQ0EsNEJBQUE7RUFDQSwyQkFBQTtFQUNBLFlBQUE7RUFDQSxhQUFBO0VBQ0EsY0FBQTtFQUNBLGtCQUFBO0VBQ0Esc0JBQUE7RUFDQSxpQkFBQTtBQWpCRiIsInNvdXJjZXNDb250ZW50IjpbIi5jYXJkIHtcbiAgYm94LXNoYWRvdzogMTBweCAxMHB4IDdweCAtM3B4IHJnYmEoMCwgMCwgMCwgMC43NSk7XG4gIC13ZWJraXQtYm94LXNoYWRvdzogMTBweCAxMHB4IDdweCAtM3B4IHJnYmEoMCwgMCwgMCwgMC43NSk7XG4gIC1tb3otYm94LXNoYWRvdzogMTBweCAxMHB4IDdweCAtM3B4IHJnYmEoMCwgMCwgMCwgMC43NSk7XG4gIHBhZGRpbmc6IDEwcHg7XG4gIC8qIFBlcm1hbGluayAtIHVzZSB0byBlZGl0IGFuZCBzaGFyZSB0aGlzIGdyYWRpZW50OiBodHRwczovL2NvbG9yemlsbGEuY29tL2dyYWRpZW50LWVkaXRvci8jZmVjY2IxKzAsZjE3NDMyKzUwLGVhNTUwNys1MSxmYjk1NWUrMTAwO1JlZCtHbG9zcyslMjMyICovXG4gIGJhY2tncm91bmQ6IHJnYigyNTQsIDIwNCwgMTc3KTsgLyogT2xkIGJyb3dzZXJzICovXG4gIGJhY2tncm91bmQ6IC1tb3otbGluZWFyLWdyYWRpZW50KFxuICAgIHRvcCxcbiAgICByZ2JhKDI1NCwgMjA0LCAxNzcsIDEpIDAlLFxuICAgIHJnYmEoMjQxLCAxMTYsIDUwLCAxKSA1MCUsXG4gICAgcmdiYSgyMzQsIDg1LCA3LCAxKSA1MSUsXG4gICAgcmdiYSgyNTEsIDE0OSwgOTQsIDEpIDEwMCVcbiAgKTsgLyogRkYzLjYtMTUgKi9cbiAgYmFja2dyb3VuZDogLXdlYmtpdC1saW5lYXItZ3JhZGllbnQoXG4gICAgdG9wLFxuICAgIHJnYmEoMjU0LCAyMDQsIDE3NywgMSkgMCUsXG4gICAgcmdiYSgyNDEsIDExNiwgNTAsIDEpIDUwJSxcbiAgICByZ2JhKDIzNCwgODUsIDcsIDEpIDUxJSxcbiAgICByZ2JhKDI1MSwgMTQ5LCA5NCwgMSkgMTAwJVxuICApOyAvKiBDaHJvbWUxMC0yNSxTYWZhcmk1LjEtNiAqL1xuICBiYWNrZ3JvdW5kOiBsaW5lYXItZ3JhZGllbnQoXG4gICAgdG8gYm90dG9tLFxuICAgIHJnYmEoMjU0LCAyMDQsIDE3NywgMSkgMCUsXG4gICAgcmdiYSgyNDEsIDExNiwgNTAsIDEpIDUwJSxcbiAgICByZ2JhKDIzNCwgODUsIDcsIDEpIDUxJSxcbiAgICByZ2JhKDI1MSwgMTQ5LCA5NCwgMSkgMTAwJVxuICApOyAvKiBXM0MsIElFMTArLCBGRjE2KywgQ2hyb21lMjYrLCBPcGVyYTEyKywgU2FmYXJpNysgKi9cbiAgZmlsdGVyOiBwcm9naWQ6RFhJbWFnZVRyYW5zZm9ybS5NaWNyb3NvZnQuZ3JhZGllbnQoIHN0YXJ0Q29sb3JzdHI9JyNmZWNjYjEnLCBlbmRDb2xvcnN0cj0nI2ZiOTU1ZScsR3JhZGllbnRUeXBlPTAgKTsgLyogSUU2LTkgKi9cbiAgaGVpZ2h0OiA2MDBweDtcbiAgbWFyZ2luOiAxMHB4IGF1dG87XG59XG5cbi5jZW50ZXIge1xuICB0ZXh0LWFsaWduOiBjZW50ZXI7XG4gIG1hcmdpbjogNXB4IGF1dG87XG59XG5cbi50aXRsZSB7XG4gIGNvbG9yOiBibGFjaztcbiAgZm9udC1mYW1pbHk6ICdLbmV3YXZlJywgY3Vyc2l2ZTtcbn1cblxuLnByaWNlIHtcbiAgY29sb3I6IHJlZDtcbiAgZm9udC1mYW1pbHk6ICdLbmV3YXZlJywgY3Vyc2l2ZTtcbn1cblxuLnN0YXIge1xuICBiYWNrZ3JvdW5kLWltYWdlOiB1cmwoJy4uLy4uLy4uLy4uL2NvbnRlbnQvaW1hZ2VzL3N0YXJfMjUwLnBuZycpO1xuICBiYWNrZ3JvdW5kLXNpemU6IDI1MHB4IDI1MHB4O1xuICBiYWNrZ3JvdW5kLXJlcGVhdDogcmVwZWF0LXg7XG4gIHdpZHRoOiAyNTBweDtcbiAgaGVpZ2h0OiAyNTBweDtcbiAgbWFyZ2luOiAwIGF1dG87XG4gIHRleHQtYWxpZ246IGNlbnRlcjtcbiAgdmVydGljYWwtYWxpZ246IG1pZGRsZTtcbiAgcGFkZGluZy10b3A6IDMwcHg7XG59XG4iXSwic291cmNlUm9vdCI6IiJ9 */\"]\n});","map":{"version":3,"mappings":"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","names":["i0","CrossSellingComponent","constructor","generalService","organisatorService","ngOnChanges","changes","undefined","product","currentValue","loadEventProductOrders","then","loadEvents","loadCrossSellingProducts","loaded","promise","Promise","resolve","reject","findEventProductOrdersByProductId","id","toPromise","res","eventProductOrders","body","forEach","element","events","push","event","loadProducts","findEventProductOrdersByEventId","epo","products","i","ele","length","prodsUnique","getUniqueListBy","sort","Math","random","arr","key","Map","map","item","values","selectors","inputs","features","decls","vars","consts","template"],"sourceRoot":"","sources":["/home/ceo/mmmm/createyourevent/src/main/webapp/app/views/product/crossSelling/crossSelling.component.html","/home/ceo/mmmm/createyourevent/src/main/webapp/app/views/product/crossSelling/crossSelling.component.ts"],"sourcesContent":["<ng-container *ngIf=\"loaded\">\n    <div class=\"box_brown\">\n        <h3 jhiTranslate=\"crossSelling.also-bought\">Customers who bought this also bought ...</h3>\n        <p-dataView [value]=\"products\" [paginator]=\"true\" [rows]=\"8\" layout=\"grid\">\n            <ng-template let-product pTemplate=\"gridItem\">\n                <div class=\"p-col-12 p-md-3\">\n                    <div class=\"card card-container\">\n                        <a href=\"/products/{{ product.id }}/view\">\n                            <h3 class=\"title\">{{ product.title }}</h3>\n                            <div class=\"center\">\n                                <img [src]=\"'data:' + product.photoContentType + ';base64,' + product.photo\" style=\"max-height: 250px; max-width: 250px\" alt=\"{{ product.title }}\"/>\n                            </div>\n                            <hr/>\n                            <div class=\"star\">\n                                <jhi-price-type [product]=\"product\"></jhi-price-type>\n                                <dl class=\"row-md jh-entity-details price\">\n                                    <dt><span jhiTranslate=\"product-detail.price\">Price</span></dt>\n                                    <dd>\n                                        <span>{{ product.price | currency }} / {{ product.amount }} {{ \"createyoureventApp.Unit.\" + product.unit  | translate }}</span>\n                                    </dd>\n                                </dl>\n                            </div>\n                        </a>\n                    </div>\n                </div>\n            </ng-template>\n        </p-dataView>\n    </div>\n</ng-container>\n","import { Component, Input, OnChanges, OnInit, SimpleChanges } from '@angular/core';\nimport { IEventProductOrder } from 'app/entities/event-product-order/event-product-order.model';\nimport { IEvent } from 'app/entities/event/event.model';\nimport { IProduct } from 'app/entities/product/product.model';\nimport { GeneralService } from 'app/general.service';\nimport { OrganisatorService } from 'app/organisator/organisator.service';\n\n@Component({\n  selector: 'jhi-cross-selling',\n  templateUrl: './crossSelling.component.html',\n  styleUrls: ['./crossSelling.component.scss']\n})\nexport class CrossSellingComponent implements OnChanges {\n  @Input() product!: IProduct;\n  eventProductOrders!: IEventProductOrder[];\n  events: IEvent[] = [];\n  products: IProduct[] = [];\n  loaded = false;\n\n  constructor(private generalService: GeneralService, private organisatorService: OrganisatorService) {}\n\n  ngOnChanges(changes: SimpleChanges): void {\n    if (changes['product'] !== undefined) {\n      this.product = changes['product'].currentValue;\n      this.loadEventProductOrders().then(() => {\n        this.loadEvents().then(() => {\n          this.loadCrossSellingProducts().then(() => {\n            this.loaded = true;\n          });\n        });\n      });\n    }\n  }\n\n  loadEventProductOrders(): Promise<void> {\n    let promise = new Promise<void>((resolve, reject) => {\n      this.generalService\n        .findEventProductOrdersByProductId(this.product.id!)\n        .toPromise()\n        .then(res => {\n          this.eventProductOrders = res.body!;\n          resolve();\n        });\n    });\n    return promise;\n  }\n\n  loadEvents(): Promise<void> {\n    let promise = new Promise<void>((resolve, reject) => {\n      this.eventProductOrders.forEach(element => {\n        this.events.push(element.event!);\n      });\n      resolve();\n    });\n    return promise;\n  }\n\n  loadProducts(id: number): Promise<void> {\n    let promise = new Promise<void>((resolve, reject) => {\n      this.generalService\n        .findEventProductOrdersByEventId(id)\n        .toPromise()\n        .then(res => {\n          res.body!.forEach(epo => {\n            if (epo.id !== this.product.id) {\n              this.products.push(epo.product!);\n            }\n          });\n          resolve();\n        });\n    });\n    return promise;\n  }\n\n  loadCrossSellingProducts(): Promise<void> {\n    let promise = new Promise<void>((resolve, reject) => {\n      let i = 0;\n      this.events.forEach(ele => {\n        i++;\n        this.loadProducts(ele.id!).then(() => {\n          if (this.events.length === i) {\n            const prodsUnique = this.getUniqueListBy(this.products, 'id');\n            this.products = prodsUnique.sort(() => Math.random() - 0.5);\n            resolve();\n          }\n        });\n      });\n    });\n    return promise;\n  }\n\n  getUniqueListBy(arr: any[], key: any): IProduct[] {\n    return [...new Map(arr.map(item => [item[key], item])).values()];\n  }\n}\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}