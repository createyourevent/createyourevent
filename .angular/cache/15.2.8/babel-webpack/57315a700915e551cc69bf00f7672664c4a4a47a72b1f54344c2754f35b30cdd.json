{"ast":null,"code":"import * as i0 from \"@angular/core\";\nimport * as i1 from \"app/general.service\";\nimport * as i2 from \"@angular/router\";\nimport * as i3 from \"app/entities/event/service/event.service\";\nimport * as i4 from \"@fortawesome/angular-fontawesome\";\nimport * as i5 from \"../../shared/language/translate.directive\";\nimport * as i6 from \"../../views/payment/payment.component\";\nimport * as i7 from \"@angular/common\";\nexport class CashboxComponent {\n  constructor(generalService, route, eventService) {\n    this.generalService = generalService;\n    this.route = route;\n    this.eventService = eventService;\n    this.filteredProductOrders = [];\n    this.filteredServicemapOrders = [];\n  }\n  ngOnInit() {\n    this.filteredProductOrders = [];\n    this.filteredServicemapOrders = [];\n    this.type = 'cashbox';\n    let eventId;\n    this.route.params.subscribe(params => {\n      eventId = params['eventId'];\n      this.id = eventId;\n      this.eventService.find(eventId).subscribe(e => {\n        this.jhiEvent = e.body;\n        this.generalService.findEventProductOrdersByEventId(eventId).subscribe(epo => {\n          this.productOrders = epo.body;\n          this.productOrders.forEach(element => {\n            if (!element.event.billedOrganisator) {\n              this.filteredProductOrders.push(element);\n            }\n          });\n        });\n        this.generalService.getAllEventServiceMapsOrdersByEventId(eventId).subscribe(smo => {\n          this.servicemapOrders = smo.body;\n          this.servicemapOrders.forEach(element => {\n            if (!element.event.billedOrganisator) {\n              this.filteredServicemapOrders.push(element);\n            }\n          });\n        });\n      });\n    });\n  }\n  getTotalProductOrders() {\n    let total = 0;\n    this.filteredProductOrders.forEach(element => {\n      total += element.product.price * element.amount;\n    });\n    return total;\n  }\n  getTotalServiceMapOrders() {\n    let total = 0;\n    let addedRideCosts = false;\n    this.filteredServicemapOrders.forEach(element => {\n      total += element.total;\n      if (!addedRideCosts) {\n        addedRideCosts = true;\n        total += element.rideCosts;\n      }\n    });\n    return total;\n  }\n  getTotal() {\n    this.total = this.genround(this.getTotalProductOrders() + this.getTotalServiceMapOrders(), 0.05);\n    return this.total;\n  }\n  genround(amt, prec) {\n    var rndd = Number((Math.round(amt / prec) * prec).toFixed(2));\n    return rndd;\n  }\n  onApproveAngular(result) {\n    this.jhiEvent.billedOrganisator = true;\n    this.eventService.update(this.jhiEvent).subscribe(() => {\n      this.ngOnInit();\n    });\n  }\n  cancel() {\n    window.history.back();\n  }\n}\nCashboxComponent.ɵfac = function CashboxComponent_Factory(t) {\n  return new (t || CashboxComponent)(i0.ɵɵdirectiveInject(i1.GeneralService), i0.ɵɵdirectiveInject(i2.ActivatedRoute), i0.ɵɵdirectiveInject(i3.EventService));\n};\nCashboxComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: CashboxComponent,\n  selectors: [[\"jhi-cashbox\"]],\n  decls: 53,\n  vars: 12,\n  consts: [[1, \"row\"], [1, \"col-md-6\"], [\"jhiTranslate\", \"cashbox.total-products\", 1, \"bold\"], [\"jhiTranslate\", \"cashbox.total-services\", 1, \"bold\"], [\"jhiTranslate\", \"cashbox.total\", 1, \"bold\"], [3, \"value\", \"type\", \"id\", \"successEvent\"], [\"type\", \"button\", \"data-dismiss\", \"modal\", 1, \"btn\", \"btn-secondary\", 3, \"click\"], [\"icon\", \"ban\"], [\"jhiTranslate\", \"entity.action.back\"]],\n  template: function CashboxComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"div\", 0);\n      i0.ɵɵtext(1, \"\\n  \");\n      i0.ɵɵelementStart(2, \"div\", 1);\n      i0.ɵɵtext(3, \"\\n    \");\n      i0.ɵɵelementStart(4, \"span\", 2);\n      i0.ɵɵtext(5, \"Total products\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(6, \"\\n  \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(7, \"\\n  \");\n      i0.ɵɵelementStart(8, \"div\", 1);\n      i0.ɵɵtext(9);\n      i0.ɵɵpipe(10, \"currency\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(11, \"\\n\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(12, \"\\n\");\n      i0.ɵɵelementStart(13, \"div\", 0);\n      i0.ɵɵtext(14, \"\\n  \");\n      i0.ɵɵelementStart(15, \"div\", 1);\n      i0.ɵɵtext(16, \"\\n    \");\n      i0.ɵɵelementStart(17, \"span\", 3);\n      i0.ɵɵtext(18, \"Total services\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(19, \"\\n  \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(20, \"\\n  \");\n      i0.ɵɵelementStart(21, \"div\", 1);\n      i0.ɵɵtext(22);\n      i0.ɵɵpipe(23, \"currency\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(24, \"\\n\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(25, \"\\n\");\n      i0.ɵɵelementStart(26, \"div\", 0);\n      i0.ɵɵtext(27, \"\\n  \");\n      i0.ɵɵelementStart(28, \"div\", 1);\n      i0.ɵɵtext(29, \"\\n    \");\n      i0.ɵɵelementStart(30, \"span\", 4);\n      i0.ɵɵtext(31, \"Total\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(32, \"\\n  \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(33, \"\\n  \");\n      i0.ɵɵelementStart(34, \"div\", 1);\n      i0.ɵɵtext(35);\n      i0.ɵɵpipe(36, \"currency\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(37, \"\\n\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(38, \"\\n\");\n      i0.ɵɵelement(39, \"hr\");\n      i0.ɵɵtext(40, \"\\n\");\n      i0.ɵɵelementStart(41, \"jhi-payment\", 5);\n      i0.ɵɵlistener(\"successEvent\", function CashboxComponent_Template_jhi_payment_successEvent_41_listener($event) {\n        return ctx.onApproveAngular($event);\n      });\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(42, \"\\n\");\n      i0.ɵɵelement(43, \"hr\");\n      i0.ɵɵtext(44, \"\\n\");\n      i0.ɵɵelementStart(45, \"button\", 6);\n      i0.ɵɵlistener(\"click\", function CashboxComponent_Template_button_click_45_listener() {\n        return ctx.cancel();\n      });\n      i0.ɵɵtext(46, \"\\n  \");\n      i0.ɵɵelement(47, \"fa-icon\", 7);\n      i0.ɵɵtext(48, \"\\u00A0\");\n      i0.ɵɵelementStart(49, \"span\", 8);\n      i0.ɵɵtext(50, \"Back\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(51, \"\\n\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(52, \"\\n\");\n    }\n    if (rf & 2) {\n      i0.ɵɵadvance(9);\n      i0.ɵɵtextInterpolate1(\"\\n    \", i0.ɵɵpipeBind1(10, 6, ctx.getTotalProductOrders()), \"\\n  \");\n      i0.ɵɵadvance(13);\n      i0.ɵɵtextInterpolate1(\"\\n    \", i0.ɵɵpipeBind1(23, 8, ctx.getTotalServiceMapOrders()), \"\\n  \");\n      i0.ɵɵadvance(13);\n      i0.ɵɵtextInterpolate1(\"\\n    \", i0.ɵɵpipeBind1(36, 10, ctx.getTotal()), \"\\n  \");\n      i0.ɵɵadvance(6);\n      i0.ɵɵproperty(\"value\", ctx.genround(ctx.total, 0.05))(\"type\", ctx.type)(\"id\", ctx.id);\n    }\n  },\n  dependencies: [i4.FaIconComponent, i5.TranslateDirective, i6.PaymentComponent, i7.CurrencyPipe],\n  styles: [\".bold[_ngcontent-%COMP%] {\\n  font-weight: bold;\\n}\\n\\n.buy[_ngcontent-%COMP%] {\\n  display: block;\\n  font-size: 12px;\\n  font-weight: bold;\\n  background-color: #5D9CEC;\\n  padding: 0 18px;\\n  line-height: 30px;\\n  border-radius: 15px;\\n  color: #fff;\\n  text-decoration: none;\\n}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9tYWluL3dlYmFwcC9hcHAvb3JnYW5pc2F0b3IvY2FzaGJveC9jYXNoYm94LmNvbXBvbmVudC5zY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0VBQ0ksaUJBQUE7QUFDSjs7QUFFQTtFQUNJLGNBQUE7RUFDQSxlQUFBO0VBQ0EsaUJBQUE7RUFDQSx5QkFBQTtFQUNBLGVBQUE7RUFDQSxpQkFBQTtFQUNBLG1CQUFBO0VBQ0EsV0FBQTtFQUNBLHFCQUFBO0FBQ0oiLCJzb3VyY2VzQ29udGVudCI6WyIuYm9sZCB7XG4gICAgZm9udC13ZWlnaHQ6IGJvbGQ7XG59XG5cbi5idXkge1xuICAgIGRpc3BsYXk6IGJsb2NrO1xuICAgIGZvbnQtc2l6ZTogMTJweDtcbiAgICBmb250LXdlaWdodDogYm9sZDtcbiAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjNUQ5Q0VDO1xuICAgIHBhZGRpbmc6IDAgMThweDtcbiAgICBsaW5lLWhlaWdodDogMzBweDtcbiAgICBib3JkZXItcmFkaXVzOiAxNXB4O1xuICAgIGNvbG9yOiAjZmZmO1xuICAgIHRleHQtZGVjb3JhdGlvbjogbm9uZTtcbiB9Il0sInNvdXJjZVJvb3QiOiIifQ== */\"]\n});","map":{"version":3,"mappings":"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","names":["CashboxComponent","constructor","generalService","route","eventService","ngOnInit","filteredProductOrders","filteredServicemapOrders","type","eventId","params","subscribe","id","find","e","jhiEvent","body","findEventProductOrdersByEventId","epo","productOrders","forEach","element","event","billedOrganisator","push","getAllEventServiceMapsOrdersByEventId","smo","servicemapOrders","getTotalProductOrders","total","product","price","amount","getTotalServiceMapOrders","addedRideCosts","rideCosts","getTotal","genround","amt","prec","rndd","Number","Math","round","toFixed","onApproveAngular","result","update","cancel","window","history","back","selectors","decls","vars","consts","template","i0","ctx"],"sourceRoot":"","sources":["/home/ceo/mmmm/createyourevent/src/main/webapp/app/organisator/cashbox/cashbox.component.ts","/home/ceo/mmmm/createyourevent/src/main/webapp/app/organisator/cashbox/cashbox.component.html"],"sourcesContent":["import { Component, OnInit } from '@angular/core';\nimport { ActivatedRoute } from '@angular/router';\nimport { GeneralService } from 'app/general.service';\nimport * as dayjs from \"dayjs\";\nimport { IEventProductOrder } from 'app/entities/event-product-order/event-product-order.model';\nimport { IEventServiceMapOrder } from 'app/entities/event-service-map-order/event-service-map-order.model';\nimport { IEvent } from 'app/entities/event/event.model';\nimport { EventService } from 'app/entities/event/service/event.service';\n\n\n@Component({\n  selector: 'jhi-cashbox',\n  templateUrl: './cashbox.component.html',\n  styleUrls: ['./cashbox.component.scss']\n})\nexport class CashboxComponent implements OnInit {\n\n  jhiEvent!: IEvent;\n  productOrders!: IEventProductOrder[];\n  servicemapOrders!: IEventServiceMapOrder[];\n  filteredProductOrders: IEventProductOrder[] = [];\n  filteredServicemapOrders: IEventServiceMapOrder[] = [];\n  total: number;\n  type: string;\n  id: number;\n\n\n  constructor(private generalService: GeneralService,\n              private route: ActivatedRoute,\n              private eventService: EventService,\n              ) {\n   }\n\n  ngOnInit(): void {\n    this.filteredProductOrders = [];\n    this.filteredServicemapOrders  =  [];\n    this.type = 'cashbox';\n    let eventId: number;\n    this.route.params.subscribe(params => {\n      eventId = params['eventId'];\n      this.id = eventId;\n      this.eventService.find(eventId).subscribe(e => {\n        this.jhiEvent = e.body!;\n\n        this.generalService.findEventProductOrdersByEventId(eventId).subscribe(epo => {\n          this.productOrders = epo.body!;\n\n          this.productOrders.forEach(element => {\n            if(!element.event.billedOrganisator) {\n              this.filteredProductOrders.push(element);\n            }\n          });\n        });\n\n        this.generalService.getAllEventServiceMapsOrdersByEventId(eventId).subscribe(smo => {\n          this.servicemapOrders = smo.body!;\n\n          this.servicemapOrders.forEach(element => {\n            if(!element.event.billedOrganisator) {\n              this.filteredServicemapOrders.push(element);\n            }\n          });\n        });\n      })\n    });\n  }\n\n  getTotalProductOrders(): number {\n    let total = 0;\n    this.filteredProductOrders.forEach(element => {\n      total += element.product.price * element.amount;\n    });\n    return total;\n  }\n\n  getTotalServiceMapOrders(): number {\n    let total = 0;\n    let addedRideCosts = false ;\n    this.filteredServicemapOrders.forEach(element => {\n      total += element.total!;\n      if(!addedRideCosts) {\n        addedRideCosts = true;\n        total += element.rideCosts!;\n      }\n    });\n    return total;\n  }\n\n  getTotal(): number {\n    this.total = this.genround((this.getTotalProductOrders() + this.getTotalServiceMapOrders()), 0.05);\n    return this.total;\n  }\n\n  genround(amt: number, prec: number): number {\n    var rndd = Number((Math.round(amt / prec) * prec).toFixed(2));\n    return rndd ;\n  }\n\n\n\n  onApproveAngular(result: any): void {\n    this.jhiEvent.billedOrganisator = true;\n    this.eventService.update(this.jhiEvent).subscribe(() => {\n      this.ngOnInit();\n    });\n  }\n\n  cancel() {\n    window.history.back();\n  }\n}\n","<div class=\"row\">\n  <div class=\"col-md-6\">\n    <span class=\"bold\" jhiTranslate=\"cashbox.total-products\">Total products</span>\n  </div>\n  <div class=\"col-md-6\">\n    {{ getTotalProductOrders() | currency }}\n  </div>\n</div>\n<div class=\"row\">\n  <div class=\"col-md-6\">\n    <span class=\"bold\" jhiTranslate=\"cashbox.total-services\">Total services</span>\n  </div>\n  <div class=\"col-md-6\">\n    {{ getTotalServiceMapOrders() | currency }}\n  </div>\n</div>\n<div class=\"row\">\n  <div class=\"col-md-6\">\n    <span class=\"bold\" jhiTranslate=\"cashbox.total\">Total</span>\n  </div>\n  <div class=\"col-md-6\">\n    {{ getTotal() | currency }}\n  </div>\n</div>\n<hr/>\n<jhi-payment [value]=\"genround(total, 0.05)\" [type]=\"type\" [id]=\"id\" (successEvent)=\" onApproveAngular($event)\"></jhi-payment>\n<hr/>\n<button type=\"button\" class=\"btn btn-secondary\" data-dismiss=\"modal\" (click)=\"cancel()\">\n  <fa-icon icon=\"ban\"></fa-icon>&nbsp;<span jhiTranslate=\"entity.action.back\">Back</span>\n</button>\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}