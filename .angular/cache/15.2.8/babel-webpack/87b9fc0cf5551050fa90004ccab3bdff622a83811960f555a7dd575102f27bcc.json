{"ast":null,"code":"import _asyncToGenerator from \"/home/ceo/mmmm/createyourevent/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { EventEmitter } from '@angular/core';\nimport SlotMachine from 'slot-machine-gen';\nimport { timer } from 'rxjs';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"app/general.service\";\nimport * as i2 from \"app/points/points-display/points-display.service\";\nimport * as i3 from \"@angular/common\";\nimport * as i4 from \"@fortawesome/angular-fontawesome\";\nimport * as i5 from \"../../../shared/language/translate.directive\";\nimport * as i6 from \"primeng/button\";\nimport * as i7 from \"@ngx-translate/core\";\nfunction SlotMachineComponent_ng_container_7_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵtext(1, \"\\n  \");\n    i0.ɵɵelementStart(2, \"div\", 5);\n    i0.ɵɵtext(3, \"\\n    \");\n    i0.ɵɵelement(4, \"img\", 6);\n    i0.ɵɵtext(5, \"\\n  \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(6, \"\\n\");\n    i0.ɵɵelementContainerEnd();\n  }\n}\nfunction SlotMachineComponent_ng_container_9_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵtext(1, \"\\n  \");\n    i0.ɵɵelement(2, \"div\", 7);\n    i0.ɵɵtext(3, \"\\n\");\n    i0.ɵɵelementContainerEnd();\n  }\n}\nfunction SlotMachineComponent_div_13_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵtext(1, \"\\n    \");\n    i0.ɵɵelementStart(2, \"div\", 8);\n    i0.ɵɵtext(3, \"\\n      \");\n    i0.ɵɵelementStart(4, \"div\", 9);\n    i0.ɵɵtext(5, \"Let's play...\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(6, \"\\n    \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(7, \"\\n  \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction SlotMachineComponent_div_15_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵtext(1, \"\\n    \");\n    i0.ɵɵelementStart(2, \"div\", 8);\n    i0.ɵɵtext(3, \"\\n      \");\n    i0.ɵɵelementStart(4, \"div\", 10);\n    i0.ɵɵtext(5, \"Lost\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(6, \"\\n    \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(7, \"\\n  \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction SlotMachineComponent_div_17_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵtext(1, \"\\n    \");\n    i0.ɵɵelementStart(2, \"div\", 8);\n    i0.ɵɵtext(3, \"\\n      \");\n    i0.ɵɵelementStart(4, \"div\", 11);\n    i0.ɵɵtext(5, \"Win\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(6, \"\\n    \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(7, \"\\n  \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction SlotMachineComponent_ng_container_20_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵtext(1, \"\\n  \");\n    i0.ɵɵelementStart(2, \"div\", 12);\n    i0.ɵɵtext(3, \"\\n    \");\n    i0.ɵɵelementStart(4, \"div\", 13);\n    i0.ɵɵtext(5, \"\\n      You don't have enough points to play. Visit www.createyourevent.org/points-list to find out how to get more points on Create Your\\n      Event to play.\\n    \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(6, \"\\n  \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(7, \"\\n\");\n    i0.ɵɵelementContainerEnd();\n  }\n}\nfunction SlotMachineComponent_ng_container_22_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r8 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵtext(1, \"\\n  \");\n    i0.ɵɵelementStart(2, \"div\", 14);\n    i0.ɵɵtext(3, \"\\n    \");\n    i0.ɵɵelementStart(4, \"button\", 15);\n    i0.ɵɵlistener(\"click\", function SlotMachineComponent_ng_container_22_Template_button_click_4_listener() {\n      i0.ɵɵrestoreView(_r8);\n      const ctx_r7 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r7.play());\n    });\n    i0.ɵɵtext(5, \"\\n      \");\n    i0.ɵɵelement(6, \"fa-icon\", 16);\n    i0.ɵɵtext(7, \"\\u00A0\");\n    i0.ɵɵelementStart(8, \"span\");\n    i0.ɵɵtext(9);\n    i0.ɵɵpipe(10, \"uppercase\");\n    i0.ɵɵpipe(11, \"translate\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(12, \"\\n    \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(13, \"\\n  \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(14, \"\\n\");\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    i0.ɵɵadvance(9);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(10, 1, i0.ɵɵpipeBind1(11, 3, \"slot-machine.play-game\")));\n  }\n}\nexport let SlotMachineComponent = /*#__PURE__*/(() => {\n  class SlotMachineComponent {\n    constructor(generalService, pointsDataService) {\n      this.generalService = generalService;\n      this.pointsDataService = pointsDataService;\n      this.clockWin = new EventEmitter();\n      this.cherryWin = new EventEmitter();\n      this.orangeWin = new EventEmitter();\n      this.plumWin = new EventEmitter();\n      this.reels = [{\n        imageSrc: '../../../content/images/slot-machine/reel-strip1.png',\n        symbols: [{\n          title: 'cherry',\n          position: 100,\n          weight: 2\n        }, {\n          title: 'plum',\n          position: 300,\n          weight: 6\n        }, {\n          title: 'orange',\n          position: 500,\n          weight: 5\n        }, {\n          title: 'bell',\n          position: 700,\n          weight: 1\n        }, {\n          title: 'cherry',\n          position: 900,\n          weight: 3\n        }, {\n          title: 'plum',\n          position: 1100,\n          weight: 5\n        }]\n      }, {\n        imageSrc: '../../../content/images/slot-machine/reel-strip2.png',\n        symbols: [{\n          title: 'orange',\n          position: 100,\n          weight: 6\n        }, {\n          title: 'plum',\n          position: 300,\n          weight: 5\n        }, {\n          title: 'orange',\n          position: 500,\n          weight: 3\n        }, {\n          title: 'plum',\n          position: 700,\n          weight: 5\n        }, {\n          title: 'cherry',\n          position: 900,\n          weight: 2\n        }, {\n          title: 'bell',\n          position: 1100,\n          weight: 1\n        }]\n      }, {\n        imageSrc: '../../../content/images/slot-machine/reel-strip3.png',\n        symbols: [{\n          title: 'cherry',\n          position: 100,\n          weight: 4\n        }, {\n          title: 'bell',\n          position: 300,\n          weight: 1\n        }, {\n          title: 'orange',\n          position: 500,\n          weight: 6\n        }, {\n          title: 'plum',\n          position: 700,\n          weight: 5\n        }, {\n          title: 'plum',\n          position: 900,\n          weight: 3\n        }, {\n          title: 'cherry',\n          position: 1100,\n          weight: 2\n        }]\n      }];\n      this.enoughtPoints = false;\n      this.state = 'new';\n    }\n    ngOnInit() {\n      var _this = this;\n      this.generalService.findWidthAuthorities().subscribe(us => {\n        this.user = us.body;\n        this.generalService.findPropertyByKey('slot_machine_start_points').subscribe( /*#__PURE__*/function () {\n          var _ref = _asyncToGenerator(function* (rt) {\n            _this.pointsStart = Number(rt.body.value);\n            if (_this.user.points >= _this.pointsStart) {\n              _this.enoughtPoints = true;\n              while (!document.querySelector('#slot-machine')) {\n                yield new Promise(r => setTimeout(r, 500));\n              }\n              var machine = document.getElementById('slot-machine');\n              _this.slot = new SlotMachine(machine, _this.reels, _this.callback.bind(_this));\n            }\n          });\n          return function (_x) {\n            return _ref.apply(this, arguments);\n          };\n        }());\n      });\n    }\n    callback(payLine) {\n      if (payLine[0].title === payLine[1].title && payLine[0].title === payLine[2].title && payLine[1].title === payLine[2].title) {\n        timer(4500).subscribe(() => {\n          if (payLine[0].title === 'bell') {\n            this.clockWin.emit();\n          }\n          if (payLine[0].title === 'cherry') {\n            this.cherryWin.emit();\n          }\n          if (payLine[0].title === 'orange') {\n            this.orangeWin.emit();\n          }\n          if (payLine[0].title === 'plum') {\n            this.plumWin.emit();\n          }\n          this.state = 'win';\n          this.pointsDataService.changePoint(this.user.points);\n          this.generalService.findWidthAuthorities().subscribe(us => {\n            this.user = us.body;\n            if (this.user.points - this.pointsStart < 0) {\n              this.enoughtPoints = false;\n            }\n          });\n        });\n      } else {\n        timer(4500).subscribe(() => {\n          this.state = 'lost';\n          this.pointsDataService.changePoint(this.user.points);\n          this.generalService.findWidthAuthorities().subscribe(us => {\n            this.user = us.body;\n            if (this.user.points - this.pointsStart < 0) {\n              this.enoughtPoints = false;\n            }\n          });\n        });\n      }\n    }\n    play() {\n      if (this.user.points - this.pointsStart < 0) {\n        this.enoughtPoints = false;\n        return;\n      }\n      this.user.points -= this.pointsStart;\n      this.generalService.updateUserLoggedInAndPoints(this.user.id, this.user.loggedIn, this.user.points).subscribe(() => {\n        this.generalService.updatePointsKeycloak(this.user.points, this.user.id).subscribe(() => {\n          this.state = 'new';\n          this.slot.play();\n        });\n      });\n    }\n  }\n  SlotMachineComponent.ɵfac = function SlotMachineComponent_Factory(t) {\n    return new (t || SlotMachineComponent)(i0.ɵɵdirectiveInject(i1.GeneralService), i0.ɵɵdirectiveInject(i2.PointsDataService));\n  };\n  SlotMachineComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: SlotMachineComponent,\n    selectors: [[\"jhi-slot-machine\"]],\n    outputs: {\n      clockWin: \"clockWin\",\n      cherryWin: \"cherryWin\",\n      orangeWin: \"orangeWin\",\n      plumWin: \"plumWin\"\n    },\n    decls: 24,\n    vars: 12,\n    consts: [[\"jhiTranslate\", \"slot-machine.one-game-costs\", 1, \"title-points-costs\"], [1, \"points-count\"], [4, \"ngIf\"], [3, \"ngSwitch\"], [4, \"ngSwitchCase\"], [1, \"text-align-center\"], [\"src\", \"../../../../content/images/slot-machine/slotmachine.png\", 1, \"slot-machine\"], [\"id\", \"slot-machine\", 1, \"slot-machine\"], [1, \"status\"], [\"jhiTranslate\", \"slot-machine.lets-play\"], [\"jhiTranslate\", \"slot-machine.lost\"], [\"jhiTranslate\", \"slot-machine.win\"], [1, \"container-not-enought-points\"], [\"jhiTranslate\", \"slot-machine.not-enought-points\", 1, \"box-not-enought-points\"], [1, \"button-slot-machine\"], [\"pButton\", \"\", \"pRipple\", \"\", \"type\", \"button\", 1, \"p-button-rounded\", \"p-button-info\", \"play-button\", 3, \"click\"], [\"icon\", \"gamepad\"]],\n    template: function SlotMachineComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0);\n        i0.ɵɵtext(1, \"One game will use\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtext(2, \"\\n\");\n        i0.ɵɵelementStart(3, \"div\", 1);\n        i0.ɵɵtext(4);\n        i0.ɵɵpipe(5, \"translate\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtext(6, \"\\n\\n\");\n        i0.ɵɵtemplate(7, SlotMachineComponent_ng_container_7_Template, 7, 0, \"ng-container\", 2);\n        i0.ɵɵtext(8, \"\\n\");\n        i0.ɵɵtemplate(9, SlotMachineComponent_ng_container_9_Template, 4, 0, \"ng-container\", 2);\n        i0.ɵɵtext(10, \"\\n\\n\");\n        i0.ɵɵelementContainerStart(11, 3);\n        i0.ɵɵtext(12, \"\\n  \");\n        i0.ɵɵtemplate(13, SlotMachineComponent_div_13_Template, 8, 0, \"div\", 4);\n        i0.ɵɵtext(14, \"\\n\\n  \");\n        i0.ɵɵtemplate(15, SlotMachineComponent_div_15_Template, 8, 0, \"div\", 4);\n        i0.ɵɵtext(16, \"\\n\\n  \");\n        i0.ɵɵtemplate(17, SlotMachineComponent_div_17_Template, 8, 0, \"div\", 4);\n        i0.ɵɵtext(18, \"\\n\");\n        i0.ɵɵelementContainerEnd();\n        i0.ɵɵtext(19, \"\\n\\n\");\n        i0.ɵɵtemplate(20, SlotMachineComponent_ng_container_20_Template, 8, 0, \"ng-container\", 2);\n        i0.ɵɵtext(21, \"\\n\");\n        i0.ɵɵtemplate(22, SlotMachineComponent_ng_container_22_Template, 15, 5, \"ng-container\", 2);\n        i0.ɵɵtext(23, \"\\n\");\n      }\n      if (rf & 2) {\n        i0.ɵɵadvance(4);\n        i0.ɵɵtextInterpolate2(\"\", ctx.pointsStart, \" \", i0.ɵɵpipeBind1(5, 10, \"slot-machine.points\"), \"\");\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"ngIf\", !ctx.enoughtPoints);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngIf\", ctx.enoughtPoints);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngSwitch\", ctx.state);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngSwitchCase\", \"new\");\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngSwitchCase\", \"lost\");\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngSwitchCase\", \"win\");\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"ngIf\", !ctx.enoughtPoints);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngIf\", ctx.enoughtPoints);\n      }\n    },\n    dependencies: [i3.NgIf, i3.NgSwitch, i3.NgSwitchCase, i4.FaIconComponent, i5.TranslateDirective, i6.ButtonDirective, i3.UpperCasePipe, i7.TranslatePipe],\n    styles: [\".slot-machine{height:480px;width:600px}.slot-machine .display{display:flex;height:inherit;position:absolute;transform:translateZ(0);width:inherit;z-index:2}.slot-machine .display .reel{background:transparent;border:1px solid #999;border-radius:10px;cursor:pointer;height:calc(100% - 103px);margin:47px 10px;overflow:hidden;width:200px}.slot-machine .display .reel:after{box-shadow:inset -3em -3em 4em #0c090a}.slot-machine .display .reel:before{box-shadow:inset -3em 3em 4em #0c090a}.slot-machine .display .reel:after,.slot-machine .display .reel:before{content:\\\"\\\";display:block;height:50%;width:calc(100% + 100px)}.slot-machine .slots{height:inherit;z-index:1;--webkit-transform: translate3d(0, 0, 0)}.slot-machine .slots .reel{display:inline-block}.slot-machine .slots .reel .strip{list-style:none;margin-left:-40px;transform-style:preserve-3d}.slot-machine .slots .reel .strip.start{animation:init .3s ease-in reverse}.slot-machine .slots .reel .strip.spin{animation:spin .6s linear infinite reverse}.slot-machine .slots .reel .strip.stop{animation:init 1s ease-out reverse}.slot-machine .slots .reel .strip li{font-size:0;position:absolute;text-align:center;-webkit-backface-visibility:hidden}#slot-machine{margin:0 auto}.text-align-center{text-align:center}#play-button{display:block;margin:0 auto;width:100px}.button-slot-machine{margin:0 auto;text-align:center}.title-points-costs{font-family:Chango,cursive;color:#ff0;text-shadow:5px 5px black;text-align:center;font-size:xx-large}.points-count{width:240px;padding:10px;z-index:6;margin:40px auto;border-radius:5px;border:4px solid black;box-shadow:5px 5px 15px 5px #ff8080,-9px 5px 15px 5px #ffe488,-7px -5px 15px 5px #8cff85,12px -5px 15px 5px #80c7ff,12px 10px 15px 7px #e488ff,-10px 10px 15px 7px #ff616b,-10px -7px 27px 1px #8e5cff,5px 5px 15px 5px #0000;font-size:xx-large;color:#fff;background:#333333;text-shadow:#fff 0px 0px 5px,#fff 0px 0px 10px,#fff 0px 0px 15px,#ff2d95 0px 0px 20px,#ff2d95 0px 0px 30px,#ff2d95 0px 0px 40px,#ff2d95 0px 0px 50px,#ff2d95 0px 0px 75px;font-family:Shrikhand,cursive;text-align:center}.box-not-enought-points{background-color:#ff0;font-weight:700;color:red;border:1px solid black;border-radius:5px;box-shadow:5px 5px 15px 5px #000;margin:20px;padding:10px;text-align:center;font-size:larger}.status{background-color:#ff0;font-weight:700;color:red;border:1px solid black;border-radius:5px;box-shadow:5px 5px 15px 5px #000;margin:20px;padding:10px;text-align:center;font-size:x-large}.container-not-enought-points{margin:0 auto}.play-button{width:300px;height:100px;text-align:center;margin:0 auto;font-size:xx-large;font-weight:700;padding:50px}\\n\"],\n    encapsulation: 2\n  });\n  return SlotMachineComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}