{"ast":null,"code":"import _defineProperty from \"/home/ceo/mmmm/createyourevent/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";\nimport { EventEmitter } from '@angular/core';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"app/general.service\";\nimport * as i2 from \"app/entities/user/user.service\";\nimport * as i3 from \"app/points/points-display/points-display.service\";\nimport * as i4 from \"@angular/forms\";\nimport * as i5 from \"@angular/common\";\nimport * as i6 from \"../../../shared/language/translate.directive\";\nimport * as i7 from \"primeng/rating\";\nfunction StarRatingComponent_ng_container_24_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r3 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵtext(1, \"\\n            \");\n    i0.ɵɵelementStart(2, \"div\", 9);\n    i0.ɵɵtext(3, \"\\n                \");\n    i0.ɵɵelementStart(4, \"p-rating\", 10);\n    i0.ɵɵlistener(\"ngModelChange\", function StarRatingComponent_ng_container_24_Template_p_rating_ngModelChange_4_listener($event) {\n      i0.ɵɵrestoreView(_r3);\n      const ctx_r2 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r2.val = $event);\n    })(\"onRate\", function StarRatingComponent_ng_container_24_Template_p_rating_onRate_4_listener($event) {\n      i0.ɵɵrestoreView(_r3);\n      const ctx_r4 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r4.onStarsChange($event));\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(5, \"\\n            \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(6, \"\\n        \");\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngModel\", ctx_r0.val)(\"stars\", ctx_r0.stars)(\"cancel\", false)(\"disabled\", true);\n  }\n}\nfunction StarRatingComponent_ng_container_26_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r6 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵtext(1, \"\\n            \");\n    i0.ɵɵelementStart(2, \"div\", 9);\n    i0.ɵɵtext(3, \"\\n                \");\n    i0.ɵɵelementStart(4, \"p-rating\", 11);\n    i0.ɵɵlistener(\"ngModelChange\", function StarRatingComponent_ng_container_26_Template_p_rating_ngModelChange_4_listener($event) {\n      i0.ɵɵrestoreView(_r6);\n      const ctx_r5 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r5.val = $event);\n    })(\"onRate\", function StarRatingComponent_ng_container_26_Template_p_rating_onRate_4_listener($event) {\n      i0.ɵɵrestoreView(_r6);\n      const ctx_r7 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r7.onStarsChange($event));\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(5, \"\\n            \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(6, \"\\n        \");\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngModel\", ctx_r1.val)(\"stars\", ctx_r1.stars)(\"cancel\", false);\n  }\n}\nexport class StarRatingComponent {\n  constructor(generalService, userService, pointsDataService) {\n    _defineProperty(this, \"generalService\", void 0);\n    _defineProperty(this, \"userService\", void 0);\n    _defineProperty(this, \"pointsDataService\", void 0);\n    _defineProperty(this, \"userLoggedIn\", void 0);\n    _defineProperty(this, \"points\", void 0);\n    _defineProperty(this, \"subscription\", void 0);\n    _defineProperty(this, \"stars\", 10);\n    _defineProperty(this, \"val\", void 0);\n    _defineProperty(this, \"comment\", '');\n    _defineProperty(this, \"disabled\", false);\n    _defineProperty(this, \"rated\", new EventEmitter());\n    this.generalService = generalService;\n    this.userService = userService;\n    this.pointsDataService = pointsDataService;\n  }\n  ngOnInit() {\n    this.subscription = this.pointsDataService.currentPoint.subscribe(points => this.points = points);\n    this.generalService.findWidthAuthorities().subscribe(u => {\n      this.userLoggedIn = u.body;\n    });\n  }\n  onStarsChange(e) {\n    this.disabled = true;\n    this.generalService.findPointsByKey('rating_stars').subscribe(p => {\n      const points = p.body.points;\n      this.userLoggedIn.points += points;\n      this.generalService.updateUserLoggedInAndPoints(this.userLoggedIn.id, this.userLoggedIn.loggedIn, this.userLoggedIn.points).subscribe(u => {\n        this.pointsDataService.changePoint(this.userLoggedIn.points);\n        const r = {\n          stars: this.val,\n          comment: this.comment\n        };\n        this.comment = '';\n        this.rated.emit(r);\n        this.disabled = true;\n      });\n    });\n  }\n}\n_defineProperty(StarRatingComponent, \"\\u0275fac\", function StarRatingComponent_Factory(t) {\n  return new (t || StarRatingComponent)(i0.ɵɵdirectiveInject(i1.GeneralService), i0.ɵɵdirectiveInject(i2.UserService), i0.ɵɵdirectiveInject(i3.PointsDataService));\n});\n_defineProperty(StarRatingComponent, \"\\u0275cmp\", /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: StarRatingComponent,\n  selectors: [[\"jhi-star-rating\"]],\n  inputs: {\n    val: \"val\",\n    disabled: \"disabled\"\n  },\n  outputs: {\n    rated: \"rated\"\n  },\n  decls: 30,\n  vars: 5,\n  consts: [[1, \"container\"], [1, \"row\"], [1, \"col-sm-9\"], [1, \"col-md-6\"], [\"role\", \"alert\", 1, \"alert\", \"alert-primary\"], [\"jhiTranslate\", \"rating.feedback\"], [1, \"col-md-6\", \"col-lg-6\"], [\"pInputTextarea\", \"\", \"autoResize\", \"autoResize\", 3, \"rows\", \"cols\", \"ngModel\", \"ngModelChange\"], [4, \"ngIf\"], [1, \"col-sm-3\"], [3, \"ngModel\", \"stars\", \"cancel\", \"disabled\", \"ngModelChange\", \"onRate\"], [3, \"ngModel\", \"stars\", \"cancel\", \"ngModelChange\", \"onRate\"]],\n  template: function StarRatingComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"div\", 0);\n      i0.ɵɵtext(1, \"\\n    \");\n      i0.ɵɵelementStart(2, \"div\", 1);\n      i0.ɵɵtext(3, \"\\n        \");\n      i0.ɵɵelementStart(4, \"div\", 2);\n      i0.ɵɵtext(5, \"\\n            \");\n      i0.ɵɵelementStart(6, \"div\", 1);\n      i0.ɵɵtext(7, \"\\n                \");\n      i0.ɵɵelementStart(8, \"div\", 3);\n      i0.ɵɵtext(9, \"\\n                    \");\n      i0.ɵɵelementStart(10, \"div\", 4);\n      i0.ɵɵtext(11, \"\\n                        \");\n      i0.ɵɵelementStart(12, \"span\", 5);\n      i0.ɵɵtext(13, \"\\n                            Before you can like, you have to enter a short feedback with at least 50 characters in the text field on the right about why you made which decision.\\n                          \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(14, \"\\n                    \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(15, \"\\n                \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(16, \"\\n                \");\n      i0.ɵɵelementStart(17, \"div\", 6);\n      i0.ɵɵtext(18, \"\\n                    \");\n      i0.ɵɵelementStart(19, \"textarea\", 7);\n      i0.ɵɵlistener(\"ngModelChange\", function StarRatingComponent_Template_textarea_ngModelChange_19_listener($event) {\n        return ctx.comment = $event;\n      });\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(20, \"\\n                \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(21, \"\\n              \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(22, \"\\n        \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(23, \"\\n        \");\n      i0.ɵɵtemplate(24, StarRatingComponent_ng_container_24_Template, 7, 4, \"ng-container\", 8);\n      i0.ɵɵtext(25, \"\\n        \");\n      i0.ɵɵtemplate(26, StarRatingComponent_ng_container_26_Template, 7, 3, \"ng-container\", 8);\n      i0.ɵɵtext(27, \"\\n    \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(28, \"\\n\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(29, \"\\n\\n\\n\");\n    }\n    if (rf & 2) {\n      i0.ɵɵadvance(19);\n      i0.ɵɵproperty(\"rows\", 5)(\"cols\", 30)(\"ngModel\", ctx.comment);\n      i0.ɵɵadvance(5);\n      i0.ɵɵproperty(\"ngIf\", ctx.disabled || ctx.comment.length <= 50);\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"ngIf\", !ctx.disabled && ctx.comment.length > 50);\n    }\n  },\n  dependencies: [i4.DefaultValueAccessor, i4.NgControlStatus, i4.NgModel, i5.NgIf, i6.TranslateDirective, i7.Rating],\n  styles: [\"\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsInNvdXJjZVJvb3QiOiIifQ== */\"]\n}));","map":{"version":3,"mappings":"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","names":["EventEmitter","i0","StarRatingComponent","constructor","generalService","userService","pointsDataService","ngOnInit","subscription","currentPoint","subscribe","points","findWidthAuthorities","u","userLoggedIn","body","onStarsChange","e","disabled","findPointsByKey","p","updateUserLoggedInAndPoints","id","loggedIn","changePoint","r","stars","val","comment","rated","emit","selectors","inputs","outputs","decls","vars","consts","template"],"sourceRoot":"","sources":["/home/ceo/mmmm/createyourevent/src/main/webapp/app/views/ratings/starRating/starRating.component.ts","/home/ceo/mmmm/createyourevent/src/main/webapp/app/views/ratings/starRating/starRating.component.html"],"sourcesContent":["import { Component, EventEmitter, Input, OnInit, Output } from '@angular/core';\nimport { IUser } from 'app/entities/user/user.model';\nimport { UserService } from 'app/entities/user/user.service';\nimport { GeneralService } from 'app/general.service';\nimport { PointsDataService } from 'app/points/points-display/points-display.service';\nimport { Subscription } from 'rxjs';\n\n@Component({\n  selector: 'jhi-star-rating',\n  templateUrl: './starRating.component.html',\n  styleUrls: ['./starRating.component.scss']\n})\nexport class StarRatingComponent implements OnInit {\n\n  userLoggedIn!: IUser;\n\n  points!: number;\n  subscription!: Subscription;\n\n  stars = 10;\n  @Input() val!: number;\n  comment = '';\n  @Input() disabled = false;\n  @Output() rated = new EventEmitter<any>();\n\n  constructor(private generalService: GeneralService, private userService: UserService, private pointsDataService: PointsDataService) {}\n\n  ngOnInit(): void {\n    this.subscription = this.pointsDataService.currentPoint.subscribe(points => (this.points = points));\n    this.generalService.findWidthAuthorities().subscribe(u => {\n      this.userLoggedIn = u.body!;\n    });\n  }\n\n  onStarsChange(e: any): void {\n    this.disabled = true;\n    this.generalService.findPointsByKey('rating_stars').subscribe(p => {\n      const points = p.body!.points;\n      this.userLoggedIn.points! += points!;\n      this.generalService.updateUserLoggedInAndPoints(this.userLoggedIn.id!, this.userLoggedIn.loggedIn!, this.userLoggedIn.points!).subscribe(u => {\n        this.pointsDataService.changePoint(this.userLoggedIn.points!);\n\n        const r = {stars: this.val, comment: this.comment}\n        this.comment = '';\n        this.rated.emit(r);\n        this.disabled = true;\n      });\n    });\n  }\n}\n","<div class=\"container\">\n    <div class=\"row\">\n        <div class=\"col-sm-9\">\n            <div class=\"row\">\n                <div class=\"col-md-6\">\n                    <div class=\"alert alert-primary\" role=\"alert\">\n                        <span jhiTranslate=\"rating.feedback\">\n                            Before you can like, you have to enter a short feedback with at least 50 characters in the text field on the right about why you made which decision.\n                          </span>\n                    </div>\n                </div>\n                <div class=\"col-md-6 col-lg-6\">\n                    <textarea [rows]=\"5\" [cols]=\"30\" pInputTextarea autoResize=\"autoResize\" [(ngModel)]=\"comment\"></textarea>\n                </div>\n              </div>\n        </div>\n        <ng-container *ngIf=\"disabled || comment.length <= 50\">\n            <div class=\"col-sm-3\">\n                <p-rating [(ngModel)]=\"val\" [stars]=\"stars\" (onRate)=\" onStarsChange($event)\" [cancel]=\"false\" [disabled]=\"true\"></p-rating>\n            </div>\n        </ng-container>\n        <ng-container *ngIf=\"!disabled && comment.length > 50\">\n            <div class=\"col-sm-3\">\n                <p-rating [(ngModel)]=\"val\" [stars]=\"stars\" (onRate)=\" onStarsChange($event)\" [cancel]=\"false\"></p-rating>\n            </div>\n        </ng-container>\n    </div>\n</div>\n\n\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}